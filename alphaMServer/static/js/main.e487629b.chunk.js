(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{159:function(e,t,a){},233:function(e,t,a){},303:function(e,t,a){e.exports=a(624)},308:function(e,t,a){},310:function(e,t,a){},373:function(e,t,a){},393:function(e,t,a){},450:function(e,t,a){},453:function(e,t,a){},624:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(23),r=a.n(i),o=(a(308),a(9)),c=a(10),s=a(13),u=a(12),d=a(14),m=(a(310),a(30)),h=a.n(m),f=(a(373),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.visible?"":" displayNone";return l.a.createElement("div",{className:"modal-base"+t,onClick:function(){return e.props.onOutsideClick()}},l.a.createElement("div",{className:"modal-body ",onClick:function(e){return e.stopPropagation()}},this.props.children))}}]),t}(n.Component)),p=a(258),b=a.n(p),v=a(655),g="token",y=b.a.create({baseURL:"https://air-reader.herokuapp.com/"});function k(){return localStorage.getItem(g)}function E(e){e,T.next(e)}var T=new v.a,N=T.asObservable(),S=new v.a,C=S.asObservable();y.interceptors.request.use(function(e){var t=k();return t?"OPTIONS"!==e.method&&(e.headers.authorization=t):E(!1),e},function(e){return Promise.reject(e)}),y.interceptors.response.use(function(e){switch(console.log(e),e.data.message&&S.next(e.data.message),e.status){case 200:if(e.request.responseURL.indexOf("authentication")>0){E(!0);var t=e.data;return console.log("token obtained ",t),t?function(e){console.log("token set",e),localStorage.setItem("token",JSON.stringify(e.token))}(t):console.log("null"),t}return!e.data||e.data;default:return console.log("unknwon error"),e}},function(e){if(console.log(e.response,e.response),!e.response)return console.log("Impossible to log in "),E(!1),Promise.reject(e);switch(e.response.data.message&&S.next(e.response.data.message),e.response.status){case 401:return console.log("bad credentials "),E(!1),Promise.reject(e);default:return console.log("Mauvaise requete"),Promise.reject(e)}}),console.log(y);var A=y,D=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"cancelBill",value:function(e){return A.post("bills/cancel",JSON.stringify(e))}},{key:"insertBill",value:function(e){return A.post("bills/insert",JSON.stringify(e))}},{key:"getAllBills",value:function(){return A.get("bills/")}},{key:"getAllTickets",value:function(){return A.get("tickets/")}},{key:"requestWithHeader",value:function(){var e={"Content-Type":"application/json",Authorization:"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWJjIiwiZXhwIjoxNTMwOTk3MTQyfQ.S2nKlQibyD7fhYaFmsbwP05AxP0fMhwNDTfUH8En_FM"};return fetch("tickets/",{method:"get",headers:e})}},{key:"insertAccount",value:function(e){return A.post("accounts/insert",JSON.stringify(e))}},{key:"deleteAccount",value:function(e){return A.post("accounts/delete",JSON.stringify(e))}},{key:"insertTicket",value:function(e){return A.post("tickets/insert",JSON.stringify(e))}},{key:"validateTicket",value:function(e){return A.post("tickets/validate",JSON.stringify(e))}},{key:"getNextBillNumber",value:function(){return A.get("bills/getNextBillNumber").then(function(e){return"AFV/18/"+"000000".substring(e.toString().length)+e.toString()+"FB"})}},{key:"sendAIRFiles",value:function(e){return console.log("files sent",e),A.post("ticket_files/insert",e)}},{key:"getAllAirFiles",value:function(e){return A.get("ticket_files/").then(function(e){return console.log(e.length+" air files retrieved",e)})}},{key:"testAirFileDatas",value:function(e){return console.log(JSON.stringify(e),e),A.post("ticket_files/check",e)}}]),e}(),x=(a(393),function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"sendDataToRetrieveToken",value:function(e){return A.post("authentication/",e)}},{key:"postToServer",value:function(e,t){return A.post(e,t)}},{key:"updateOnServer",value:function(e,t){return A.put(e,t)}},{key:"deleteOnServer",value:function(e,t){return A.delete(e+t)}},{key:"getFromServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.projection,l=void 0===n?null:n,i=a.sort,r=void 0===i?null:i,o=a.limit,c=void 0===o?0:o;return t||l||r||c?A.post(e+"filter/",Object.assign({projection:l,sort:r,limit:c},{filter:t})):A.get(e)}}]),e}()),I=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).emptyAccountData={name:"",adress:"",city:"",country:"",mail:"",phone:"","customer reference":"","customer account":"","entire name":"","with FS":!0,"paiement type":"Cash"},e.state={accountData:{name:"",clientNumber:"",adress:"",city:"",country:"",mail:"",phone:"","customer reference":"","customer account":"",accountlibele:"","entire name":"","with FS":!0,"paiement type":"Cash"},accountDataModel:{name:{inputType:"text",inputPlaceholder:"AFV",labelValue:"Nom abr\xe9g\xe9"},adress:{inputType:"text",inputPlaceholder:"Rue de nachtigal - B.P. 245",labelValue:"Adresse"},city:{inputType:"text",inputPlaceholder:"Yaound\xe9",labelValue:"Ville"},country:{inputType:"text",inputPlaceholder:"Cameroun",labelValue:"Cameroun"},mail:{inputType:"text",inputPlaceholder:"afv_cameroun@yahoo.fr",labelValue:"Mail"},phone:{inputType:"text",inputPlaceholder:"(+ 237) 6 77 93 78 21 - 22",labelValue:"Telephone"},"customer reference":{inputType:"text",inputPlaceholder:"AFV/18/0001465CL",labelValue:"Reference client"},"customer account":{inputType:"text",inputPlaceholder:"411-AFV",labelValue:"Compte client"},"entire name":{inputType:"text",inputPlaceholder:"Agence Fran\xe7aise de Voyages",labelValue:"Nom entier"},"with FS":{inputType:"checkbox",labelValue:"FS inclus dans facture",inputChecked:!0},"paiement type":{inputType:"text",inputPlaceholder:"CASH",labelValue:"Type de paiement"}}},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"insertAccount",value:function(e){console.log(e.state.accountData),x.postToServer("accounts/",this.state.accountData).then(function(t){var a=h()(e.state.accountData);a._id=t,e.resetAccountData(),e.props.onAddNewAccount(a)})}},{key:"updateAccount",value:function(e){x.updateOnServer("accounts/",this.state.accountData).then(function(t){if(t){var a=h()(e.state.accountData);e.resetAccountData(),e.props.onUpdateAccount(a)}})}},{key:"deleteAccount",value:function(e){x.deleteOnServer("accounts/",this.state.accountData._id).then(function(t){if(t){var a=h()(e.state.accountData);e.resetAccountData(),e.props.onDeleteAccount(a)}})}},{key:"resetAccountData",value:function(){this.setState({accountData:h()(this.emptyAccountData)})}},{key:"componentDidMount",value:function(){this.props.accountToModify&&this.setState({accountData:h()(this.props.accountToModify)})}},{key:"handleInputChangeOnAccountData",value:function(e){console.log(e.target,e.target.value,e.target.checked);var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name,l=h()(this.state.accountData);console.log(l),l[n]=a,this.setState({accountData:l})}},{key:"setAccountData",value:function(e){this.setState({accountData:h()(e)})}},{key:"componentWillReceiveProps",value:function(e){e.accountToModify?this.props.accountToModify!==e.accountToModify&&this.setAccountData(e.accountToModify):this.resetAccountData()}},{key:"modificationMessage",value:function(){var e=this;return"_id"in this.state.accountData?l.a.createElement("div",null,"Mise \xe0 jour du compte ",this.state.accountData.name,l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("button",{onClick:function(){return e.updateAccount(e)}},"Mettre \xe0 jour compte client"),l.a.createElement("button",{onClick:function(){return e.deleteAccount(e)}},"Supprimer compte client"))):l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return e.insertAccount(e)}},"Creer nouveau compte client"))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(B,{data:this.state.accountData,dataModel:this.state.accountDataModel,handleInputChangeOnAccountData:function(t){return e.handleInputChangeOnAccountData(t)}}),this.modificationMessage())}}]),t}(n.Component);function B(e){var t=Object.keys(e.dataModel).map(function(t,a){return l.a.createElement("div",{className:"flex-container",key:a},l.a.createElement("label",{className:"flex-1-1 text-right"},e.dataModel[t].labelValue),"checkbox"===e.dataModel[t].inputType?l.a.createElement("input",{name:t,placeholder:e.dataModel[t].inputPlaceholder,type:e.dataModel[t].inputType,onChange:e.handleInputChangeOnAccountData,checked:e.data[t],className:"flex-3-1"}):l.a.createElement("input",{name:t,value:e.data[t],placeholder:e.dataModel[t].inputPlaceholder,type:e.dataModel[t].inputType,onChange:e.handleInputChangeOnAccountData,className:"flex-3-1"}))});return l.a.createElement("div",{className:"margin-bottom-20px"},t)}var O=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"sortAlphabatically",value:function(e,t){var a=e.toLowerCase(),n=t.toLowerCase();return a<n?-1:a>n?1:0}},{key:"sortAlphabaticallyWithKey",value:function(t){return Array.isArray(t)?function(a,n){return e.sortAlphabatically(t.reduce(function(e,t){return e+a[t]},""),t.reduce(function(e,t){return e+n[t]},""))}:function(a,n){return e.sortAlphabatically(a[t],n[t])}}}]),e}(),w=a(140),F=a(298),V=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={anchorEl:null},a.handleClose=a.props.handleClose,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.anchorEl;return l.a.createElement(w.a,{id:"simple-menu",anchorEl:this.props.anchorEl,open:Boolean(e),onClose:this.handleClose},this.props.menuItems.map(function(e,t){return l.a.createElement(F.a,{onClick:function(){return e.action()},key:t},e.text)}))}}]),t}(l.a.Component),j=a(101),_=a(131),M=a(132),R=a(133),L=a(74),K=a(183),P=a.n(K),U=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={elementModified:null,connexionRunning:!1},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.setState({elementModified:null}),this.props.onClose()}},{key:"handleValidation",value:function(){var e=this;this.props.onValidate?this.props.onValidate(this.state.elementModified,function(){return e.handleClose()}):this.handleClose()}},{key:"setConnexionRunning",value:function(e){this.setState({connexionRunning:e})}},{key:"modifyObjectOnServer",value:function(){this.setConnexionRunning(!0)}},{key:"onEnterClick",value:function(e){"Enter"===e.key&&this.handleValidation()}},{key:"render",value:function(){var e=this;return l.a.createElement(j.a,{open:this.props.open,onClose:function(){return e.handleClose()},onKeyPress:function(t){return e.onEnterClick(t)},"aria-labelledby":"form-dialog-title",fullWidth:!0},l.a.createElement(_.a,{id:"form-dialog-title"},this.props.title),l.a.createElement(M.a,null,this.props.editable?l.a.createElement(P.a,{indentWidth:10,enableClipboard:!1,onEdit:function(t){return e.setState({elementModified:t.updated_src})},src:this.props.objectToModify,theme:"rjv-default"}):l.a.createElement(P.a,{indentWidth:10,enableClipboard:!1,src:this.props.objectToModify,theme:"rjv-default"})),l.a.createElement(R.a,null,l.a.createElement(L.a,{onClick:function(){return e.handleValidation()},color:"primary",disabled:this.state.connexionRunning},"Valider")))}}]),t}(l.a.Component);U.defaultProps={editable:!0};var Y=a(81),H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={keyToResearch:"",valueToResearch:"",selected:[],multiChoice:a.props.multiChoice,simpleMenuAnchorEl:null,elementToModify:null,modifyElementModalOpen:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"filterAction",value:function(e,t,a){return e.filter(function(e){var n=!0,l=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var c=r.value;if(c in e&&e[c].indexOf(a)>-1)return!0}}catch(s){l=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(l)throw i}}})}},{key:"onResearchValueChange",value:function(e){this.setState({valueToResearch:e.target.value.toUpperCase()})}},{key:"onResearchElementChange",value:function(e){this.setState({keyToResearch:e.target.value})}},{key:"handleClickOnElement",value:function(e){var t=this.state.selected;console.log(this.state.multiChoice,t),this.state.multiChoice?(t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.setState({selected:t}),console.log(this.state.selected)):(this.setState({selected:[e]}),this.props.onValid(e))}},{key:"selectElements",value:function(e){this.setState({selected:h()(e)})}},{key:"validateSelection",value:function(){this.props.onValid(this.state.selected),this.setState({selected:[]})}},{key:"render",value:function(){var e=this,t=this.props.sortBy?this.props.data.sort(O.sortAlphabaticallyWithKey(this.props.sortBy)):this.props.data;this.state.valueToResearch&&(t=this.filterAction(t,this.props.filterPossibilities,this.state.valueToResearch));var a=l.a.createElement(W,{dataToRender:t,onElementClick:function(t){return e.handleClickOnElement(t)},onElementContextMenu:function(t,a){console.log("click droit element",t),t.preventDefault(),e.setState({simpleMenuAnchorEl:t.target,elementToModify:a})},dataKeysToShow:this.props.dataKeysToShow,dataAlreadySelected:this.state.selected});return l.a.createElement("div",{className:"margin-left-right-auto "+this.props.className},this.state.multiChoice?l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return e.validateSelection()}},"Valider"),l.a.createElement("button",{onClick:function(){return e.selectElements(t)}},"Selectionner Tout")):"",l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("label",null,"Filtr\xe9 selon ",JSON.stringify(this.props.filterPossibilities))),l.a.createElement("div",null,l.a.createElement(Y.a,{autoFocus:!0,margin:"dense",name:"username",label:"Valeur cherchee",type:"text",onChange:function(t){return e.onResearchValueChange(t)}})),l.a.createElement(V,{anchorEl:this.state.simpleMenuAnchorEl,handleClose:function(){e.setState({simpleMenuAnchorEl:null,elementToModify:null})},menuItems:[{text:"Afficher element",action:function(){return e.setState({modifyElementModalOpen:!0,simpleMenuAnchorEl:null})}}]}),l.a.createElement(U,{open:this.state.modifyElementModalOpen,onClose:function(){return e.setState({modifyElementModalOpen:!1})},title:"Modifier objet",objectToModify:this.state.elementToModify,editable:!1})),a)}}]),t}(n.Component);function X(e){var t=e.dataKeysToShow,a=e.selected?"bold-text":"";return l.a.createElement("div",{onClick:e.onClick,onContextMenu:function(t){return e.onContextMenu(t)},className:a},l.a.createElement("div",null,t.map(function(t){return e.data[t]+"  "})))}function W(e){var t=e.dataAlreadySelected,a=e.dataToRender.map(function(a,n){return l.a.createElement(X,{key:n,data:a,onClick:function(){return e.onElementClick(a)},onContextMenu:function(t){return e.onElementContextMenu(t,a)},dataKeysToShow:"function"===typeof e.dataKeysToShow?e.dataKeysToShow(a):e.dataKeysToShow,selected:t?t.includes(a):""})});return l.a.createElement("div",{className:"list-element-div scrollable text-left "+e.className},a)}function J(e){return console.log("propsCustomerAccount",e,e.multiChoice),l.a.createElement(H,{onValid:e.onValid,data:e.data,sortBy:"name",dataKeysToShow:e.dataKeysToShow?e.dataKeysToShow:["name","customer account","customer reference"],filterPossibilities:e.filterPossibilities?e.filterPossibilities:["customer reference","name","entire name"],multiChoice:!0===e.multiChoice})}var q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={accountToModify:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"setAccountToModify",value:function(e){this.setState({accountToModify:e})}},{key:"clickOnNewAccountButton",value:function(){this.setAccountToModify(null)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"flex-container"},l.a.createElement("div",null,l.a.createElement(J,{data:this.props.allAccount,onValid:function(t){return e.setAccountToModify(t)},multiChoice:!1})),l.a.createElement("div",null,l.a.createElement(I,{onAddNewAccount:function(t){return e.props.addNewAccount(t)},onUpdateAccount:function(t){return e.props.updateAccount(t)},onDeleteAccount:function(t){return e.props.deleteAccount(t)},accountToModify:this.state.accountToModify}),l.a.createElement("button",{onClick:function(){return e.clickOnNewAccountButton()}}," Nouveau compte")))}}]),t}(n.Component),z=a(4),Q=a(46);function G(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(e.length<1)return l.a.createElement("a",null,"Pas de tickets \xe0 ce jour");var n={};Object.keys(e[0]).map(function(e){n[e]=e});var i=a||n;e.unshift(i);var r=function(e){for(var t="object"!==typeof e?JSON.parse(e):e,a="",n=0;n<t.length;n++){var l="";for(var i in t[n])""!==l&&(l+=";"),l+=t[n][i];a+=l+"\r\n"}return a}(JSON.stringify(e)),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),c=t+".csv"||"export.csv",s=URL.createObjectURL(o);return l.a.createElement("a",{href:s,download:c},"Telecharger ",c)}a(233);var $=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={selectedDatas:"",LOCAL_STORAGE_KEY:"STATE_KEYS_STORAGE",savedConfigurationListInLocalStorage:{},configurationName:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.retrieveSavedDataListFromLocalStorage()}},{key:"componentWillReceiveProps",value:function(e){e.initialDatas!==this.props.initialDatas&&this.resetDatas(e.initialDatas)}},{key:"retrieveSavedDataListFromLocalStorage",value:function(){var e=localStorage.getItem(this.state.LOCAL_STORAGE_KEY);this.setState({savedConfigurationListInLocalStorage:e?JSON.parse(e):{}})}},{key:"addConfigurationToLocalStorage",value:function(){var e=Object.assign({},this.state.savedConfigurationListInLocalStorage);e[this.state.configurationName]=this.state.selectedDatas,localStorage.setItem(this.state.LOCAL_STORAGE_KEY,JSON.stringify(e)),this.retrieveSavedDataListFromLocalStorage()}},{key:"updateTextAreaConfigurationValue",value:function(e){this.setState({selectedDatas:e})}},{key:"updateConfigurationNameValue",value:function(e){this.setState({configurationName:e})}},{key:"resetDatas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.initialDatas;this.setState({selectedDatas:JSON.stringify(e).replace(/,/g,",\n")})}},{key:"activateConfigurationFromLocalStorage",value:function(e){this.updateTextAreaConfigurationValue(e),this.props.validateNewConfiguration(e)}},{key:"render",value:function(){var e=this;return console.log(this.state.savedConfigurationListInLocalStorage),this.state.selectedDatas||this.resetDatas(),l.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginBottom:"10px"}},l.a.createElement("div",null,Object.keys(this.state.savedConfigurationListInLocalStorage).map(function(t){return l.a.createElement("div",{key:t,onClick:function(){return e.activateConfigurationFromLocalStorage(e.state.savedConfigurationListInLocalStorage[t])}},t)})),l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("button",null,"Columns"),l.a.createElement("button",null,"Filter"),l.a.createElement("button",null,"Subtotal")),l.a.createElement("textarea",{value:this.state.selectedDatas,onChange:function(t){return e.updateTextAreaConfigurationValue(t.target.value)},style:{width:"300px",height:"200px",margin:"0px 10px"}})),l.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},l.a.createElement("button",{onClick:function(){return e.props.validateNewConfiguration(e.state.selectedDatas)}},"Validate"),l.a.createElement("button",{onClick:function(){return e.resetDatas()}},"Reset"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("input",{value:this.state.configurationName,style:{textAlign:"center"},placeholder:"Configuration name",onChange:function(t){return e.updateConfigurationNameValue(t.target.value)}}),l.a.createElement("button",{onClick:function(){return e.addConfigurationToLocalStorage()}},"Save configuration")))}}]),t}(n.Component),Z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={selectedDatas:[],initialDatas:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.selectorDatas.selectedDatas?this.setState({selectedDatas:e.selectorDatas.selectedDatas,initialDatas:e.selectorDatas.selectedDatas}):this.resetSelectedDatas()}},{key:"resetSelectedDatas",value:function(){this.setState({selectedDatas:[]})}},{key:"addItemToSelection",value:function(e){var t=Array.from(this.state.selectedDatas);t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.setState({selectedDatas:t})}},{key:"createItemsFromDatas",value:function(){var e=this;return this.props.selectorDatas.datas.sort().map(function(t,a){return l.a.createElement("div",{onClick:function(){return e.addItemToSelection(t)},key:a},l.a.createElement("input",{type:"checkbox",checked:e.state.selectedDatas.includes(t)}),t?t.toString():"no value")})}},{key:"selectAllElements",value:function(){this.setState({selectedDatas:this.props.selectorDatas.datas.map(function(e){return e})})}},{key:"validateSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.selectedDatas;this.props.selectorDatas.validateFilterValues(e),this.resetSelectedDatas()}},{key:"render",value:function(){var e=this;return"none"===this.props.selectorDatas.display?null:l.a.createElement("div",{style:{position:"absolute",backgroundColor:"#bbbbbb",left:this.props.selectorDatas.X,top:this.props.selectorDatas.Y,display:this.props.selectorDatas.display,padding:"15px",borderRadius:"4px"}},l.a.createElement("button",{onClick:function(){e.resetSelectedDatas()}},"None"),l.a.createElement("button",{onClick:function(){e.selectAllElements()}},"All"),l.a.createElement("button",{style:{},onClick:function(){e.validateSelection()}},"Validate"),l.a.createElement("span",{style:{position:"absolute",right:"4px",top:"4px"},onClick:function(){return e.validateSelection(e.state.initialDatas)}}," ",l.a.createElement("i",{className:"fas fa-times"})),l.a.createElement("div",{style:{overflowY:"auto",maxHeight:"300px"}},this.createItemsFromDatas()))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={shouldUpdateDataTableData:!1,currentKeysToShowObject:"",initialKeysToShow:"",selectorDatas:{X:0,Y:0,display:"none",validateFilterValues:function(e){return console.log(e)},datas:[]},sortBy:{},filterBy:{},simpleMenuAnchorEl:null,elementToModify:null,modifyElementModalOpen:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.startTime!==this.state.startTime&&this.setState({startTime:e.startTime}),this.refreshDataTableData(e)}},{key:"getDataKeysToShowFromData",value:function(e){var t=new Set,a=!0,n=!1,l=void 0;try{for(var i,r=e[Symbol.iterator]();!(a=(i=r.next()).done);a=!0)for(var o=i.value,c=Object.keys(o),s=0;s<c.length;s++){var u=c[s];t.add(u)}}catch(d){n=!0,l=d}finally{try{a||null==r.return||r.return()}finally{if(n)throw l}}return Object(Q.a)(t).reduce(function(e,t){return e[t]=t,e},{})}},{key:"setSortBy",value:function(e){var t=Object.assign({},this.state.sortBy);switch(t[e]){case-1:delete t[e];break;case 1:t[e]=-1;break;default:t[e]=1}this.setState({sortBy:t})}},{key:"checkIfSortedByKey",value:function(e){return Object.keys(this.state.sortBy).includes(e)}},{key:"getSortingFunction",value:function(e){var t=Object.keys(e).filter(function(t){return 0!==e[t]});return function(a,n){var l=!0,i=!1,r=void 0;try{for(var o,c=t[Symbol.iterator]();!(l=(o=c.next()).done);l=!0){var s=o.value;if(a[s]!==n[s])return(a[s]<n[s]?-1:1)*e[s]}}catch(u){i=!0,r=u}finally{try{l||null==c.return||c.return()}finally{if(i)throw r}}return 0}}},{key:"setFilterBy",value:function(e,t){var a=Object.assign({},this.state.filterBy);0===t.length?delete a[e]:a[e]=t,this.setState({filterBy:a})}},{key:"checkIfFilteredBy",value:function(e){return!!this.state.filterBy[e]}},{key:"getFilteringFunction",value:function(e){console.log(e);var t=Object.keys(e);return function(a){for(var n=0;n<t.length;n++){var l=t[n];if(!e[l].includes(a[l]))return!1}return!0}}},{key:"filterButtonClick",value:function(e,t,a){var n=this;e.stopPropagation();var l=e.target.parentNode.parentNode.getBoundingClientRect(),i=new Set,r=!0,o=!1,c=void 0;try{for(var s,u=a[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=s.value;i.add(d[t])}}catch(m){o=!0,c=m}finally{try{r||null==u.return||u.return()}finally{if(o)throw c}}console.log(i),this.setState({selectorDatas:{X:l.left+window.scrollX,Y:l.bottom+window.scrollY,display:"initial",validateFilterValues:function(e){n.setFilterBy(t,e),n.setState({selectorDatas:{display:"none"}})},datas:Object(Q.a)(i),selectedDatas:this.state.filterBy[t]}})}},{key:"refreshDataTableData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=this.getDataKeysToShowFromData(e.dataToShow);this.setState({initialKeysToShow:t,currentKeysToShowObject:t})}},{key:"setKeysToShowObject",value:function(e){this.setState({currentKeysToShowObject:e})}},{key:"getSortOrientation",value:function(e){return this.checkIfSortedByKey(e)?this.state.sortBy[e]>0?l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort-up"})):l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort-down"})):l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort"}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.currentKeysToShowObject);if(console.log(this.state.filterBy),!this.state.currentKeysToShowObject)return this.refreshDataTableData(),null;this.state.shouldUpdateDataTableData&&this.refreshDataTableData(),console.log(this.state.sortBy,t);var a=this.props.dataToShow.filter(this.getFilteringFunction(this.state.filterBy));a=a.sort(this.getSortingFunction(this.state.sortBy)),console.log("header object ",o);var n=l.a.createElement("thead",null,l.a.createElement("tr",null,t.map(function(t,a){return l.a.createElement("td",{key:a,onClick:function(){return e.setSortBy(t)}},l.a.createElement("div",{className:"flex"},l.a.createElement("span",{className:"flex-1-1"},e.state.currentKeysToShowObject[t]),e.getSortOrientation(t),l.a.createElement("span",{onClick:function(a){return e.filterButtonClick(a,t,e.props.dataToShow)}},l.a.createElement("i",{className:"fas fa-filter",style:{color:e.checkIfFilteredBy(t)?"red":""}}))))}))),i=a.map(function(a,n){var i=t.map(function(e,t){return l.a.createElement("td",{key:t},"object"===typeof a[e]?"object":a[e])});return l.a.createElement("tr",{onContextMenu:function(t){console.log("modification TODO",t),t.preventDefault(),e.setState({simpleMenuAnchorEl:t.target,elementToModify:a})},key:n,onClick:function(t){console.log("modification TODO",t),t.preventDefault(),e.setState({simpleMenuAnchorEl:t.target,elementToModify:a})}},i)}),r=l.a.createElement("div",{id:"superDataTableDiv"},l.a.createElement("table",{id:"superDataTable",className:"text-left"},n,l.a.createElement("tbody",null,i))),o=t.reduce(function(t,a){return t[a]=e.state.currentKeysToShowObject[a],t},{}),c=a.map(function(e){return a=e,t.map(function(e){return e in a?Object(z.a)({},e,a[e]):{}}).reduce(function(e,t){return Object.assign(e,t)},{});var a});return l.a.createElement("div",null,l.a.createElement($,{initialDatas:this.state.initialKeysToShow,validateNewConfiguration:function(t){return e.setKeysToShowObject(JSON.parse(t))}}),l.a.createElement(Z,{selectorDatas:this.state.selectorDatas}),l.a.createElement("button",{onClick:function(){return e.refreshDataTableData()}},"Refresh data keys"),l.a.createElement("br",null),G(c,"selection"),l.a.createElement("div",null,JSON.stringify(this.state.sortBy)),l.a.createElement("div",{style:{whiteSpace:"pre"}},Object.entries(this.state.sortBy).reduce(function(e,t){return e+=t[0]+"/"+t[1]+" \n "},"")),r,l.a.createElement(V,{anchorEl:this.state.simpleMenuAnchorEl,handleClose:function(){e.setState({simpleMenuAnchorEl:null,elementToModify:null})},menuItems:[{text:"Modifier element",action:function(){return e.setState({modifyElementModalOpen:!0,simpleMenuAnchorEl:null})}}]}),l.a.createElement(U,{open:this.state.modifyElementModalOpen,onClose:function(){return e.setState({modifyElementModalOpen:!1})},title:"Modifier objet",objectToModify:this.state.elementToModify}))}}]),t}(n.Component);ee.defaultProps={editable:!0};var te,ae,ne,le,ie,re,oe,ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={modalVisibility:!1,modalComponent:"",dateBeginFilterInputValue:"000000",dateEndFilterInputValue:"999999",ticketsToShow:[],linkButton:"",linkButton2:l.a.createElement("div",null),linkButtonBAD:l.a.createElement("div",null),allBills:[],accountChosen:[],accountIdsWanted:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getAllBills",value:function(e){D.getAllBills().then(function(t){e.setState({allBills:t})})}},{key:"componentDidMount",value:function(){this.getAllBills(this)}},{key:"dateFilterFunction",value:function(e,t){return e.date>=t.state.dateBeginFilterInputValue&&e.date<=t.state.dateEndFilterInputValue}},{key:"checkedAndCanceledFilterFunction",value:function(e,t){return!0===e.checked&&!e.canceled}},{key:"accountIdsFilterFunction",value:function(e,t){return 0===t.state.accountIdsWanted.length||t.state.accountIdsWanted.includes(e.customerId)}},{key:"ticketsForStateFilterFunction",value:function(e,t){return this.checkedAndCanceledFilterFunction(e,t)&&this.dateFilterFunction(e,t)&&this.accountIdsFilterFunction(e,t)}},{key:"accountFilterFunction",value:function(e,t){}},{key:"handleDateFilterInputChange",value:function(e){var t=e.target.value.split("-");t[0]=t[0].substring(2);var a=t.join("");console.log(a),this.setState(Object(z.a)({},e.target.name,a))}},{key:"getBADBills",value:function(){return this.state.allBills.filter(function(e){return["5b3b85d086672557efc4843f","5b3b87c986672557efc48441","5b3b86d786672557efc48440","5b3b88c486672557efc48442","5b3b8a6886672557efc48443"].includes(e.customerAccount)})}},{key:"getBillsFromTicket",value:function(e){var t=this.state.allBills.filter(function(t){return!!e.billed&&(e.billed.bill_id===t._id&&"fees"!==t.valueBilled)});return 1===t.length?t[0]:t}},{key:"getRemarksFromBill",value:function(e){return e.billNumber+";"+e.commandNumber+";"+e.remarks}},{key:"genererEtats",value:function(){var e=this,a=this.props.allTickets.filter(function(t){return e.ticketsForStateFilterFunction(t,e)}),n=a.sort(function(e,a){return t.sortAlphabatically(e.date,a.date)}),l=this.getTicketsByCustomerName(n),i=[];Object.keys(l).reduce(function(e,t){i=i.concat(l[t])},[]),i=i.map(function(t){return e.retrieveUsefullDatasForStatesFromTicket(t,e)});var r=a.sort(function(e,a){return t.sortAlphabatically(e.ticketNumber.substring(4),a.ticketNumber.substring(4))}).map(function(t){return e.retrieveUsefullDatasForStatesFromTicket(t,e)}),o=a.sort(function(e,a){return t.sortAlphabatically(e.ticketNumber.substring(0,3)+e.date,a.ticketNumber.substring(0,3)+a.date)}),c=o[0].ticketNumber.substring(0,3);console.log(o);for(var s=o.length-1;s>-1;s--){console.log(s);var u=o[s];s===o.length-1&&(c=o[s].ticketNumber.substring(0,3)),c!==u.ticketNumber.substring(0,3)&&(o.splice(s+1,0,{name:c}),c=u.ticketNumber.substring(0,3))}i=o.map(function(t){return e.retrieveUsefullDatasForStatesFromTicket(t,e)}),console.log(i);var d=this.exportCSVFileButtonLink(i,"etats_du"+this.state.dateBeginFilterInputValue+"_au_"+this.state.dateEndFilterInputValue),m=this.exportCSVFileButtonLink(r,"etats_du"+this.state.dateBeginFilterInputValue+"_au_"+this.state.dateEndFilterInputValue+"_par_numero_de_ticket"),h=this.props.allTickets.filter(function(t){return e.checkedAndCanceledFilterFunction(t,e)&&e.dateFilterFunction(t,e)}).filter(function(e){return["5b3b85d086672557efc4843f","5b3b87c986672557efc48441","5b3b86d786672557efc48440","5b3b88c486672557efc48442","5b3b8a6886672557efc48443"].includes(e.customerId)}).sort(function(e,a){return t.sortAlphabatically(e.date,a.date)});h.map(function(t){var a=e.getBillsFromTicket(t);t.note0=e.getRemarksFromBill(a)});var f=this.getTicketsByCustomerName(h);console.log("tickets BAD",h);var p=[];Object.keys(f).reduce(function(e,t){p=p.concat(f[t])},[]),console.log(p),p=p.map(this.retrieveBADDatasFromTicket);var b=this.exportCSVFileButtonLink(p,"etats_BAD_du"+this.state.dateBeginFilterInputValue+"_au_"+this.state.dateEndFilterInputValue+"_par_numero_de_ticket");this.setState({ticketsToShow:i,linkButton:d,linkButton2:m,linkButtonBAD:b})}},{key:"retrieveUsefullDatasForStatesFromTicket",value:function(e){var a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this).getBillsFromTicket(e),n="";return a.remarks&&(n=a.remarks.split(";").reduce(function(e,t){var a=t.split(":");return a.length>1&&(e[a[0].trim()]=a[1]),e},{})),console.log(e,a,n),{"Date d'emission":t.retriveValueFromKeyAndValueIfNothing(e,"date"," "),"Date de depart":e.flightDates&&e.flightDates.length>0?e.flightDates[0]:"","Date de retour":e.flightDates&&e.flightDates.length>1?e.flightDates[1]:"",Nom:t.retriveValueFromKeyAndValueIfNothing(e,"name"),"Compte client":t.retriveValueFromKeyAndValueIfNothing(e,"customerAccount"),Compagnie:t.retriveValueFromKeyAndValueIfNothing(e,"companyName"),"Numero billet":t.retriveValueFromKeyAndValueIfNothing(e,"ticketNumber"),Parcours:t.retriveValueFromKeyAndValueIfNothing(e,"trip"),Classe:"",Facture:e.billed&&e.billed.bill_number?e.billed.bill_number:" ","BC/Trip":t.retriveValueFromKeyAndValueIfNothing(a,"commandNumber"),CC:t.retriveValueFromKeyAndValueIfNothing(n,"CC"),OI:t.retriveValueFromKeyAndValueIfNothing(n,"IO"),DEPT:"",PERS:t.retriveValueFromKeyAndValueIfNothing(n,"Commande suivie par ".trim()),PNR:"",HT:parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceHT",0),10),Taxes:parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceTTC",0),10)-parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceHT",0),10),"Montant/FCFA":parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceTTC",0),10),"Frais de service":parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"fees",0),10),"% commission":t.retriveValueFromKeyAndValueIfNothing(e,"commissionRate"),"valeur commission":t.retriveValueFromKeyAndValueIfNothing(e,"commissionValue"),Note:t.retriveValueFromKeyAndValueIfNothing(a,"remarks").split("\n").join(""),Note1:t.retriveValueFromKeyAndValueIfNothing(e,"note1")}}},{key:"retrieveBADDatasFromTicket",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.billed&&e.billed;return{"Date d'emission":t.retriveValueFromKeyAndValueIfNothing(e,"date"," "),"Date de depart":e.flightDates&&e.flightDates.length>0?e.flightDates[0]:"","Date de retour":e.flightDates&&e.flightDates.length>1?e.flightDates[1]:"",Nom:t.retriveValueFromKeyAndValueIfNothing(e,"name"),"Compte client":t.retriveValueFromKeyAndValueIfNothing(e,"customerAccount"),Compagnie:t.retriveValueFromKeyAndValueIfNothing(e,"companyName"),"Numero billet":t.retriveValueFromKeyAndValueIfNothing(e,"ticketNumber"),Parcours:t.retriveValueFromKeyAndValueIfNothing(e,"trip"),Classe:"",Facture:e.billed&&e.billed.bill_number?e.billed.bill_number:" ","BC/Trip":"",CC:"",OI:"",DEPT:"",PERS:"",PNR:"",HT:parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceHT",0),10),Taxes:parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceTTC",0),10)-parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceHT",0),10),"Montant/FCFA":parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"priceTTC",0),10),"Frais de service":parseInt(t.retriveValueFromKeyAndValueIfNothing(e,"fees",0),10),"% commission":t.retriveValueFromKeyAndValueIfNothing(e,"commissionRate"),"valeur commission":t.retriveValueFromKeyAndValueIfNothing(e,"commissionValue"),Note:t.retriveValueFromKeyAndValueIfNothing(e,"note0"),Note1:t.retriveValueFromKeyAndValueIfNothing(e,"note1")}}},{key:"convertToCSV",value:function(e){for(var t="object"!==typeof e?JSON.parse(e):e,a="",n=0;n<t.length;n++){var l="";for(var i in t[n])""!==l&&(l+=";"),l+=t[n][i];a+=l+"\r\n"}return a}},{key:"exportCSVFileButtonLink",value:function(e,t){var a={};if(e.length<1)return l.a.createElement("a",null,"Pas de tickets \xe0 ce jour");Object.keys(e[0]).map(function(e){a[e]=e}),e.unshift(a);var n=JSON.stringify(e),i=this.convertToCSV(n),r=new Blob([i],{type:"text/csv;charset=utf-8;"}),o=t+".csv"||"export.csv";console.log(i);var c=URL.createObjectURL(r);return l.a.createElement("a",{href:c,download:o},"Telecharger ",o)}},{key:"getCustomersAccountName",value:function(){var e={};return this.props.allAccount.reduce(function(t,a){var n=a._id,l=a.name;e[n]=l},{}),e}},{key:"ksort",value:function(e){var t=Object.keys(e);return t.sort(),t.reduce(function(t,a){return t[a]=e[a],t},{})}},{key:"getTicketsByCustomerName",value:function(e){var t=this,a=this.getCustomersAccountName(),n={};return e.reduce(function(e,t){var l=a[t.customerId];l in n?n[l].push(t):n[l]=[t]},{}),Object.keys(n).map(function(e){n[e]=t.calculateTotals(n[e]),n[e][0].name=e}),n.zTotal=[this.calculateTotals(Object.keys(n).map(function(e){return n[e][0]}))[0]],n.zTotal[0].name="zTotal",console.log(n),console.log("test contenu",n),this.ksort(n)}},{key:"calculateTotals",value:function(e){var t=e.reduce(function(e,t){return e.priceHT+=parseInt(t.priceHT,10),e.priceTTC+=parseInt(t.priceTTC,10),e.fees+=parseInt(t.fees,10),e.commissionValue+=parseInt(t.commissionValue,10),e},{priceHT:0,priceTTC:0,fees:0,commissionValue:0});return e.unshift(t),e}},{key:"getDataWantedOnTicket",value:function(){return["Date d'emission","Date de depart","Date de retour","Nom","Compte client","Compagnie","Numero billet","Parcours","Classe","Facture","BC/Trip","CC","OI","DEPT","PERS","PNR","HT","Taxes","Montant/FCFA","Frais de service","% commission","valeur commission","Note","Note1"]}},{key:"openModalAndChooseAccountsForState",value:function(e){return new Promise(function(t,a){var n=l.a.createElement(J,{onValid:function(a){e.setModalVisibility(!1),t(a)},data:e.props.allAccount,multiChoice:!0});e.setModalVisibility(!0,n)})}},{key:"setModalVisibility",value:function(e,t){(this.state.modalVisibility!==e||e)&&this.setState({modalVisibility:e}),t&&this.setState({modalComponent:t})}},{key:"setAccountChosen",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this).setState({accountChosen:e,accountIdsWanted:e.map(function(e){return e._id})}),console.log("accountChosen",e)}},{key:"render",value:function(){var e=this,t=this.state.ticketsToShow.map(function(t,a){var n=e.getDataWantedOnTicket().map(function(e,a){return l.a.createElement("td",{className:"border-all",key:a},t[e])});return l.a.createElement("tr",{className:t["Date d'emission"].trim()?"":"company-name-row",key:t["Numero billet"]+t.Nom,onClick:function(){return console.log(t)}},n)}),a=l.a.createElement("table",{className:"text-left"},l.a.createElement("tbody",null,t));return l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("div",{className:"flex-container"},l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("label",null,"Date de d\xe9but"),l.a.createElement("input",{placeholder:"Jour",type:"date",name:"dateBeginFilterInputValue",onChange:function(t){return e.handleDateFilterInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Date de fin"),l.a.createElement("input",{placeholder:"Jour",type:"date",name:"dateEndFilterInputValue",onChange:function(t){return e.handleDateFilterInputChange(t)}}))),l.a.createElement("div",{className:"flex-container-column"},this.state.accountChosen?this.state.accountChosen.map(function(e){return l.a.createElement("div",null,e.name)}):"Pas de compte selectionn\xe9",l.a.createElement("div",{onClick:function(){return e.openModalAndChooseAccountsForState(e).then(function(t){return e.setAccountChosen(t)})}},"Choisir compte")),l.a.createElement("div",{className:"flex-container-column"},this.state.linkButton?"T\xe9l\xe9charger selection affich\xe9e":"Pas d'etat cree",this.state.linkButton,this.state.linkButton2)),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return e.genererEtats()}},"Generer etat")),l.a.createElement("div",{className:"flex-container flex-direction-column"},this.state.linkButtonBAD),l.a.createElement("div",null,a),l.a.createElement(f,{visible:this.state.modalVisibility,onOutsideClick:function(){return e.setModalVisibility(!1,"")}},this.state.modalComponent))}}],[{key:"sortAlphabatically",value:function(e,t){var a=e.toLowerCase(),n=t.toLowerCase();return a<n?-1:a>n?1:0}},{key:"retriveValueFromKeyAndValueIfNothing",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e[t]?e[t]:a}}]),t}(n.Component),se=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"cancelCreditNote",value:function(e){return A.post("credit_note/cancel",JSON.stringify(e._id))}},{key:"insertCreditNote",value:function(e){return A.post("credit_note/insert",JSON.stringify(e))}},{key:"insertCreditNoteBill",value:function(e){return A.post("credit_note/bill/insert",JSON.stringify(e))}},{key:"cancelCreditNoteBillRequest",value:function(e){return A.post("credit_note/bill/cancel",JSON.stringify(e._id))}},{key:"getAllCreditNoteBills",value:function(){return A.get("credit_note/bill/")}},{key:"getAllCreditNotes",value:function(){return A.get("credit_note/")}},{key:"getNextCreditNoteBillNumber",value:function(){return A.get("credit_note/getNextCreditNoteBillNumber").then(function(e){return"AFV/18/"+"000000".substring(e.toString().length)+e.toString()+"AB"})}}]),e}(),ue=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],de=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],me=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];function he(e){switch(e.length){case 1:case 2:return fe(e);case 3:return function(e){return e>1?ue[e]+" cent":1==e?" cent":""}(e.charAt(0))+" "+he(e.substring(1));default:return(le=e.substring(0,e.length-3)).length<4?(1==le?"":he(le))+function(e){return e>=1?" mille":""}(le)+" "+he(e.substring(le.length)):he(ie=le.substring(0,le.length-3))+function(e){return e>1?" millions":" million"}(ie)+" "+he(e.substring(ie.length))}}function fe(e){return e<10?ue[parseInt(e)]:e>9&&e<20?de[e.charAt(1)]:(te=0==e.charAt(1)&&7!=e.charAt(0)&&9!=e.charAt(0)?"":1==e.charAt(1)&&e.charAt(0)<8?" et ":"-",ae=7==e.charAt(0)||9==e.charAt(0)?de[e.charAt(1)]:ue[e.charAt(1)],ne=80==e?"s":"",me[e.charAt(0)]+ne+te+ae)}function pe(e){if(!/^\d+[.,]?\d*$/.test(e))return"L'expression entr\xe9e n'est pas un nombre.";var t=(e=(e=(e=e.toString()).replace(/(^0+)|(\.0+$)/g,"")).replace(/([.,]\d{2})\d+/,"$1")).replace(/[,.]\d*/,""),a=t!=e&&e.replace(/\d*[,.]/,"");if(re=t?he(t):"",oe=a?he(a):"",!t&&!a)return"Z\xe9ro Euros. (Mais, de pr\xe9f\xe9rence, entrez une valeur non nulle!)";return t>1?"s":"",(re+" FCFA"+(a&&t?"  et ":"")+oe+(a?" centime":"")+(a>1?"s":"")).replace(/\s+/g," ").replace("cent s E","cents E")}function be(e){return l.a.createElement("div",{className:e.className+" text-left"},l.a.createElement("div",null,e.accountToShow.name),l.a.createElement("div",null,e.accountToShow["customer reference"]),l.a.createElement("div",null,e.accountToShow.adress),l.a.createElement("div",null,e.accountToShow.city+" - "+e.accountToShow.country),l.a.createElement("div",null,e.accountToShow["entire name"]),l.a.createElement("div",null,"Avec FS : "+e.accountToShow["with FS"]),l.a.createElement("div",null,"Type de paiement : "+e.accountToShow["paiement type"]))}a(159),a(450);function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="";return(t=e?new Date(e):new Date).getDate()+" "+["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","aout","septembre","octobre","novembre","d\xe9cembre"][t.getMonth()]+" "+t.getFullYear()}var ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={companyDatas:{name:"Agence Fran\xe7aise de Voyages",adress:"B.P. 245, Yaounde",tel:"(+237) 77 93 78 21 - 22",mail:"afv_cameroun@yahoo.fr",contribuable_ID:"N\xb0 CONTRIBUABLE : P036300272328L"}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getTicketArray",value:function(){var e=this;return this.props.ticketsSelected.map(function(t){var a="DEP : "+t.flightDates[0];return t.flightDates.length>1&&(a=a+" RET "+t.flightDates[1]),l.a.createElement("tr",{key:t._id,className:" no-border ticket-tr"},l.a.createElement("td",{className:"no-border border-right padding-5px"},l.a.createElement("div",null,t.ticketNumber),l.a.createElement("div",{className:e.props.showDetailsData?"":"displayNone"},t.date)),l.a.createElement("td",{className:"no-border border-right padding-5px"},l.a.createElement("div",null,t.companyName+" : "+t.trip),l.a.createElement("div",null,t.name),l.a.createElement("div",null,a)),l.a.createElement("td",{className:"no-border text-right padding-5px"},parseInt(t[e.props.valueToBill],10).toLocaleString()))})}},{key:"render",value:function(){return l.a.createElement("div",{className:this.props.className},l.a.createElement(Ne,{printable:this.props.printable,className:"centeredDiv text-left "+(this.props.accountSelected&&this.props.ticketsSelected.length>0?"":"displayNone"),billType:"FACTURE",billNumber:this.props.billNumber,companyDatas:this.state.companyDatas,accountSelected:this.props.accountSelected,remarks:this.props.remarks,date:this.props.dateToShow},l.a.createElement(Se,{ticketsSelected:this.props.ticketsSelected,valueToBill:this.props.valueToBill,accountSelected:this.props.accountSelected,commandNumber:this.props.commandNumber,billNumber:this.props.billNumber,showDetailsData:this.props.showDetailsData})))}}]),t}(n.Component);function ye(e){return l.a.createElement("div",{className:e.className},l.a.createElement("div",{className:"bold-text all-caps "},e.companyDatas.name),l.a.createElement("div",null,e.companyDatas.adress),l.a.createElement("div",null,e.companyDatas.tel),l.a.createElement("div",null,e.companyDatas.mail),l.a.createElement("div",null,e.companyDatas.contribuable_ID))}function ke(e){return l.a.createElement("div",{className:e.className},l.a.createElement("div",null,l.a.createElement("div",{className:"bold-text all-caps customerAccountNameDiv"},e.accountSelected["entire name"]),l.a.createElement("div",null,e.accountSelected.adress),l.a.createElement("div",null,e.accountSelected.city+(e.accountSelected.country?" - "+e.accountSelected.country:"")),l.a.createElement("div",null,e.accountSelected.phone?"Tel :"+e.accountSelected.phone:"")))}function Ee(e){return l.a.createElement("div",null,l.a.createElement("div",{className:e.limitDateHidden?"displayNone":"padding-5px "},"Ech\xe9ance : ",e.date),l.a.createElement("div",{className:"white-space-wrap padding-5px"},e.remarks?e.remarks.split(";").map(function(e){return l.a.createElement("div",{key:e},e)}):""),l.a.createElement("div",{className:"flex-container"},l.a.createElement("span",{className:"text-left padding-5px flex-1-1"},e.isCreditNote?"Le b\xe9n\xe9ficiaire":""),l.a.createElement("span",{className:"text-right padding-5px"}," La Direction")))}function Te(e){return l.a.createElement("div",null,l.a.createElement("div",{className:"flex-container"},l.a.createElement("div",{className:"flex-1-1"},l.a.createElement("img",{src:"/static/AFV Name.png",id:"companyLogo",alt:"company logo",className:""})),l.a.createElement("div",{className:"all-caps"},l.a.createElement("span",{className:"bold-text"},e.billType+" n\xb0")," ",e.billNumber)),l.a.createElement("div",{className:"flex-container margin-bottom-20px padding-5px"},l.a.createElement(ye,{companyDatas:e.companyDatas,className:"flex-1-1 "}),l.a.createElement(ke,{className:" ",accountSelected:e.accountSelected})))}function Ne(e){return l.a.createElement("div",{id:e.printable?"bill_preview":"",className:e.className},l.a.createElement(Te,{billType:e.billType,billNumber:e.billNumber,companyDatas:e.companyDatas,accountSelected:e.accountSelected}),l.a.createElement("div",{className:"padding-5px "},"Yaound\xe9, le ",ve(e.date)),e.children,l.a.createElement(Ee,{isCreditNote:e.isCreditNote,remarks:e.remarks,limitDateHidden:e.limitDateHidden,date:ve(e.date)}))}function Se(e){var t=e.ticketsSelected.map(function(t){var a="DEP : "+t.flightDates[0];return t.flightDates.length>1&&(a=a+" RET "+t.flightDates[1]),l.a.createElement("tr",{key:t._id,className:" no-border ticket-tr"},l.a.createElement("td",{className:"no-border border-right padding-5px"},l.a.createElement("div",null,t.ticketNumber),l.a.createElement("div",{className:e.showDetailsData?"":"displayNone"},t.date)),l.a.createElement("td",{className:"no-border border-right padding-5px"},l.a.createElement("div",null,t.companyName+" : "+t.trip),l.a.createElement("div",null,t.name),l.a.createElement("div",null,a)),l.a.createElement("td",{className:"no-border text-right padding-5px"},parseInt(t[e.valueToBill],10).toLocaleString()))}),a=e.ticketsSelected.reduce(function(t,a){return t+parseInt(a[e.valueToBill],10)},0),n=0,i=0,r=0,o=a+n+i+r,c=pe(o);return l.a.createElement("div",null,l.a.createElement("table",{className:"ticketBillDisplay"},l.a.createElement("thead",{className:"my-header align-top"},l.a.createElement("tr",null,l.a.createElement("td",{className:"padding-5px border-right"},l.a.createElement("div",null,"Bon de commande"),l.a.createElement("div",null,e.commandNumber)),l.a.createElement("td",{className:"padding-5px border-right"},l.a.createElement("div",null,"Reference client : ",e.accountSelected["customer reference"]),l.a.createElement("div",null,"Compte : ",e.accountSelected["customer account"])),l.a.createElement("td",{className:"padding-5px "},e.billNumber)),l.a.createElement("tr",null,l.a.createElement("th",{className:"padding-5px width-150px"},"Reference"),l.a.createElement("th",{className:"padding-5px"},"Designation"),l.a.createElement("th",{className:"padding-5px width-130px"},"Montant"))),l.a.createElement("tbody",{className:"align-top"},t)),l.a.createElement("div",{className:"flex-container page-break"},l.a.createElement("div",{className:"flex-3-1"}),l.a.createElement("div",{className:"no-padding"},l.a.createElement("table",null,l.a.createElement("tbody",null,[{textToShow:"Total",valueToShow:a},{textToShow:"Frais de service",valueToShow:n},{textToShow:"Remise",valueToShow:i},{textToShow:"TVA",valueToShow:r},{textToShow:"Net \xe0 payer (F CFA)",valueToShow:o}].map(function(e){return l.a.createElement("tr",{key:e.textToShow},l.a.createElement("td",{className:"width-150px border-all"},e.textToShow),l.a.createElement("td",{className:"width-130px text-right border-all padding-5px"},e.valueToShow.toLocaleString()))}))))),l.a.createElement("div",{className:"flex-container flex-direction-column padding-5px"},l.a.createElement("div",{className:"all-caps bold-text"},c),l.a.createElement("div",{className:"flex-3-1"},"Mode de paiement : ",e.accountSelected["paiement type"])))}var Ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={companyDatas:{name:"Agence Fran\xe7aise de Voyages",adress:"B.P. 245, Yaounde",tel:"(+237) 77 93 78 21 - 22",mail:"afv_cameroun@yahoo.fr",contribuable_ID:"N\xb0 CONTRIBUABLE : P036300272328L"}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:this.props.className},l.a.createElement(Ne,{printable:this.props.printable,className:"centeredDiv text-left "+(this.props.accountSelected&&this.props.creditNotes.length>0?"":"displayNone"),billType:"Avoir",billNumber:this.props.billNumber,companyDatas:this.state.companyDatas,accountSelected:this.props.accountSelected,remarks:this.props.remarks,date:this.props.dateToShow,limitDateHidden:!0,isCreditNote:!0},l.a.createElement(Ae,{creditNotes:this.props.creditNotes,accountSelected:this.props.accountSelected,commandNumber:this.props.commandNumber,billNumber:this.props.billNumber,paymentType:this.props.paymentType,showDetailsData:this.props.showDetailsData})))}}]),t}(n.Component);function Ae(e){var t=e.creditNotes.map(function(t,a){return l.a.createElement(De,{key:a,creditNote:t,showDetailsData:e.showDetailsData})}),a=0,n=0,i=0,r=0;e.creditNotes.reduce(function(e,t){return a+=parseInt(t.initialTicketAmount,10),n+=parseInt(t.amountUsed,10),i+=parseInt(t.cancelationFees,10),i+=parseInt(t.agencyFees,10),r+=parseInt(t.netToRefund,10),0},0);var o=pe(r),c=[l.a.createElement("tr",{key:"totalValueNames flex-container"},[{textToShow:"Montant initial",valueToShow:a,className:"bold-text"},{textToShow:"Montant imput\xe9",valueToShow:n+i,className:"bold-text"},{textToShow:"Montant rembours\xe9",valueToShow:0,className:"bold-text"},{textToShow:"Montant restant",valueToShow:r,className:"bold-text"}].map(function(e){return l.a.createElement("td",{key:e.textToShow,className:"flex-1-1 border-right padding-5px "+e.className},e.textToShow)})),l.a.createElement("tr",{key:"totalValues"},[{textToShow:"Montant initial",valueToShow:a,className:"bold-text"},{textToShow:"Montant imput\xe9",valueToShow:n+i,className:"bold-text"},{textToShow:"Montant rembours\xe9",valueToShow:0,className:"bold-text"},{textToShow:"Montant restant",valueToShow:r,className:"bold-text"}].map(function(e){return l.a.createElement("td",{key:e.textToShow,className:"flex-1-1 border-right text-right padding-5px "},e.valueToShow.toLocaleString())}))];return l.a.createElement("div",null,l.a.createElement("table",null,l.a.createElement("thead",{className:"my-header align-top"},l.a.createElement("tr",null,l.a.createElement("td",{className:"border-right padding-5px"},l.a.createElement("div",null,"Bon de commande"),l.a.createElement("div",null,e.commandNumber)),l.a.createElement("td",{className:"border-right padding-5px"},l.a.createElement("div",null,"Reference client : ",e.accountSelected["customer reference"]),l.a.createElement("div",null,"Compte : ",e.accountSelected["customer account"])),l.a.createElement("td",{className:"border-right padding-5px "},e.billNumber)),l.a.createElement("tr",null,l.a.createElement("th",{className:"padding-5px width-150px"},"Reference"),l.a.createElement("th",{className:"padding-5px"},"Designation"),l.a.createElement("th",{className:"padding-5px width-130px"},"Montant"))),l.a.createElement("tbody",{className:"align-top"},t)),l.a.createElement("br",null),l.a.createElement("div",{className:"no-padding"},l.a.createElement("table",{className:"equal-width-table"},l.a.createElement("tbody",null,c))),l.a.createElement("div",{className:"flex-container flex-direction-column padding-5px"},l.a.createElement("div",null,"Arret\xe9 le pr\xe9sent avoir \xe0 la somme de ",l.a.createElement("span",{className:"all-caps bold-text"},o))))}function De(e){var t=e.creditNote,a=t.cancelationFees+t.agencyFees;return[l.a.createElement("tr",{key:"ticketNumber&Date",className:" no-border ticket-tr"},l.a.createElement("td",{className:"no-border border-right"},l.a.createElement("div",{className:"padding-left-5px"},t.ticketNumber),l.a.createElement("div",{className:e.showDetailsData?"":"displayNone"},t.date)),l.a.createElement("td",{className:"no-border border-right padding-left-5px"},l.a.createElement("div",null,t.passengerName)),l.a.createElement("td",null)),l.a.createElement("tr",{key:"companyName",className:"no-border"},l.a.createElement("td",{className:"border-right padding-left-5px medium-font"},t.ticket_bill_number),l.a.createElement("td",{className:"padding-left-5px border-right small-font"}," ",t.companyName+" : "+t.trip),l.a.createElement("td",null)),l.a.createElement("tr",{key:"flightCancelation",className:"no-border"},l.a.createElement("td",{className:"border-right"}," ",e.showDetailsData?"":t.date),l.a.createElement("td",{className:"border-right small-font padding-left-20px"}," Annulation du voyage"),l.a.createElement("td",null)),l.a.createElement("tr",{key:"initialTicketAmountLine",className:"no-border credit_note_bill_line"},l.a.createElement("td",{className:"border-right"}),l.a.createElement("td",{className:"border-right small-font"}," Montant initial du billet"),l.a.createElement("td",{className:"text-right padding-right-5px"},t.initialTicketAmount.toLocaleString())),l.a.createElement("tr",{key:"amountUsedLine",className:"no-border credit_note_bill_line"},l.a.createElement("td",{className:"border-right"}),l.a.createElement("td",{className:"border-right "}," Montant utilis\xe9"),l.a.createElement("td",{className:"text-right padding-right-5px"},t.amountUsed.toLocaleString())),l.a.createElement("tr",{key:"cancelationFeesLine",className:"no-border credit_note_bill_line"},l.a.createElement("td",{className:"border-right"}),l.a.createElement("td",{className:"border-right "},"Frais d'annulation"),l.a.createElement("td",{className:"text-right padding-right-5px"},a.toLocaleString())),l.a.createElement("tr",{key:"netToRefundLine",className:"border-bottom text-right"},l.a.createElement("td",{className:"border-right"}),l.a.createElement("th",{className:"border-right no-border padding-5px"},"Net \xe0 rembourser"),l.a.createElement("th",{className:"no-border padding-5px"},t.netToRefund.toLocaleString()))]}var xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={billCreationStage:0,accountSelected:"",creditNotesSelected:[],creditNoteNumber:"",billTotalMoneyNumbers:"",isValidateBillButtonDisabled:"",validateButtonMessage:"",commandNumber:"",remarks:"",dateToShow:(new Date).getTime(),paymentType:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onAccountSelected",value:function(e){console.log("accountSelected",e),this.setState({accountSelected:e,creditNotesSelected:[],paymentType:e["paiement type"]}),this.setBillCreationStage(1)}},{key:"setBillCreationStage",value:function(e){this.setState({billCreationStage:e})}},{key:"unselectAccount",value:function(){this.setBillCreationStage(0),this.setState({accountSelected:""})}},{key:"getValueToBill",value:function(){return this.state.accountSelected["with FS"]?"total":"priceTTC"}},{key:"onCreditNotesSelected",value:function(e){var t=this;console.log("creditNotesSelected",e);var a=e.reduce(function(e,a){return e+parseInt(a[t.getValueToBill()],10)},0),n={totalToPay:a,fees:0,discount:0,TVA:0,netToPay:a+0+0+0,netToPayInLetters:pe(a+0+0+0)};se.getNextCreditNoteBillNumber().then(function(e){return t.setState({creditNoteNumber:e})}),this.setState({creditNotesSelected:e,billTotalMoneyNumbers:n,isValidateBillButtonDisabled:!1,validateButtonMessage:this.VALIDATE_BILL}),this.setBillCreationStage(2)}},{key:"filterFunction",value:function(e,t){return e.customerId===t.state.accountSelected._id&&!e.canceled&&!e.billed}},{key:"handleCreditNoteBillMakerInputChange",value:function(e){this.setState(Object(z.a)({},e.target.name,e.target.value))}},{key:"generateCreditNoteBillAndSend",value:function(e){var t={billNumber:this.state.creditNoteNumber,credit_notes:this.state.creditNotesSelected.map(function(e){return[e._id,e.netToRefund]}),customerId:this.state.accountSelected._id,customerAccount:this.state.accountSelected.name,totalBilled:this.state.creditNotesSelected.reduce(function(e,t){return e+=t.netToRefund},0)};console.log("creditNoteBill",t),se.insertCreditNoteBill(t).then(function(t){t&&(console.log("creditNoteBillReturned",t),e.props.addCreditNoteBill(t.credit_note_bill,t.credit_notes_updated),e.unselectAccount())})}},{key:"render",value:function(){var e=this,t=this.props.allCreditNotes.filter(function(t){return e.filterFunction(t,e)});return console.log(t),l.a.createElement("div",{className:"flex-container flex-direction-column "},l.a.createElement("div",{className:"margin-left-right-auto"},l.a.createElement("div",{onClick:function(){return e.unselectAccount()}},"Choisir compte"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onAccountSelected(t)},data:this.props.allAccount,sortBy:"name",dataKeysToShow:["name","customer reference"],filterPossibilities:["name","customer reference"],multiChoice:!1,className:0===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(be,{accountToShow:this.state.accountSelected,className:this.state.billCreationStage>0?"":"displayNone"})),l.a.createElement("div",{className:"margin-left-right-auto margin-bottom-20px "+(this.state.accountSelected?"":"displayNone")},l.a.createElement("div",{onClick:function(){return e.setBillCreationStage(1)}},"Selectionner avoirs"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onCreditNotesSelected(t)},data:t,dataKeysToShow:["ticketNumber","passengerName","initialTicketAmount","netToRefund"],filterPossibilities:["ticketNumber","passengerName"],multiChoice:!0,className:1===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(W,{dataToRender:this.state.creditNotesSelected,onElementClick:function(e){return console.log(e)},dataKeysToShow:["ticketNumber","passengerName","initialTicketAmount","netToRefund"],className:this.state.billCreationStage>1?"":"displayNone"})),l.a.createElement("div",{className:"flex-container padding-20px margin-20-px"},l.a.createElement("div",null,l.a.createElement("div",{className:"margin-left-right-auto position-sticky text-left "+(this.state.creditNotesSelected.length>0?"":"displayNone")},l.a.createElement("div",null,l.a.createElement("label",null,"Facture n\xb0 : "),l.a.createElement("input",{name:"creditNoteNumber",value:this.state.creditNoteNumber,onChange:function(t){return e.handleCreditNoteBillMakerInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Bon de commande : "),l.a.createElement("input",{name:"commandNumber",onChange:function(t){return e.handleCreditNoteBillMakerInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Mode de paiement : "),l.a.createElement("input",{name:"paymentType",value:this.state.paymentType,onChange:function(t){return e.handleCreditNoteBillMakerInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",{className:"align-top"},"Remarques : "),l.a.createElement("textarea",{id:"remark-field-bill-maker",name:"remarks",onChange:function(t){return e.handleCreditNoteBillMakerInputChange(t)}})),l.a.createElement("button",{className:this.state.creditNotesSelected.length>0?"":"displayNone ",onClick:function(){return e.generateCreditNoteBillAndSend(e)},disabled:this.state.isValidateBillButtonDisabled},this.state.validateButtonMessage," Valider"))),l.a.createElement(Ce,{printable:!1,accountSelected:this.state.accountSelected,creditNotes:this.state.creditNotesSelected,dateToShow:this.state.dateToShow,billNumber:this.state.creditNoteNumber,commandNumber:this.state.commandNumber,remarks:this.state.remarks,valueToBill:this.state.valueToBill,showDetailsData:!0,paymentType:this.state.paymentType,className:"flex-1-1"})))}}]),t}(n.Component);function Ie(e){return l.a.createElement("div",{className:e.className?e.className:"flex-container"},l.a.createElement("label",{className:"flex-1-1 margin-3-2"},e.labelValue),"checkbox"===e.inputType?l.a.createElement("input",{name:e.keyToModify,checked:e.inputValue,type:e.inputType,onChange:function(t){return e.onChange(t)},className:"flex-1-1"}):l.a.createElement("input",{name:e.keyToModify,value:e.inputValue,type:e.inputType,onChange:function(t){return e.onChange(t)},className:"flex-1-1"}))}function Be(e){var t=l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("div",{className:"flex-container"},l.a.createElement("div",{className:"flex-1-1 margin-5px padding-5px"},[{dataKeyToShow:"ticketNumber",labelValue:"Numero de ticket",inputType:"text"},{dataKeyToShow:"name",labelValue:"Identit\xe9 du passager",inputType:"text"},{dataKeyToShow:"accountName",labelValue:"Nom renseign\xe9 par agent",inputType:"text"},{dataKeyToShow:"customerAccount",labelValue:"Nom de compte \xe0 attribuer",inputType:"text"}].map(function(t){return l.a.createElement(Ie,{inputValue:e.data[t.dataKeyToShow],labelValue:t.labelValue,keyToModify:t.dataKeyToShow,inputType:t.inputType,key:t.dataKeyToShow,onChange:function(t){return e.handleInputChangeOnTicket(t)}})})),l.a.createElement("div",{className:"flex-1-1 margin-5px padding-5px"},[{dataKeyToShow:"companyName",labelValue:"Compagnie",inputType:"text"},{dataKeyToShow:"trip",labelValue:"Voyages",inputType:"text"},{dataKeyToShow:"flightDates",labelValue:"Dates de vol",inputType:"text"},{dataKeyToShow:"emissionDate",labelValue:"Dates de creation et modif dossier",inputType:"text"},{dataKeyToShow:"date",labelValue:"Date d'emission",inputType:"text"}].map(function(t){return l.a.createElement(Ie,{inputValue:e.data[t.dataKeyToShow],labelValue:t.labelValue,keyToModify:t.dataKeyToShow,inputType:t.inputType,key:t.dataKeyToShow,onChange:function(t){return e.handleInputChangeOnTicket(t)}})})),l.a.createElement("div",{className:"flex-1-1 margin-5px  padding-5px"},[{dataKeyToShow:"commissionRate",labelValue:"Commission (% du HT)",inputType:"text"},{dataKeyToShow:"commissionValue",labelValue:"Valeur de la commission",inputType:"text"},{dataKeyToShow:"priceHT",labelValue:"Prix HT",inputType:"number"},{dataKeyToShow:"priceTTC",labelValue:"Prix TTC",inputType:"number"},{dataKeyToShow:"fees",labelValue:"Frais de service",inputType:"number"},{dataKeyToShow:"total",labelValue:"Total \xe0 payer",inputType:"number"}].map(function(t){return l.a.createElement(Ie,{inputValue:e.data[t.dataKeyToShow],labelValue:t.labelValue,keyToModify:t.dataKeyToShow,inputType:t.inputType,key:t.dataKeyToShow,onChange:function(t){return e.handleInputChangeOnTicket(t)}})}))),l.a.createElement("div",null,l.a.createElement(Ie,{labelValue:"Billet annul\xe9 ? ",keyToModify:"canceled",inputType:"checkbox",onChange:function(t){return e.handleInputChangeOnTicket(t)},inputValue:e.data.canceled,className:"block-container"})),Object.keys(e.data).includes("billed")?l.a.createElement("div",null,"Facture billet : ",e.data.billed.bill_number," / ",e.data.billed.value_billed.toLocaleString()," FCFA"):"",Object.keys(e.data).includes("billed_fees")?l.a.createElement("div",null,"Facture FS : ",e.data.billed_fees.bill_number," / ",e.data.billed_fees.value_billed.toLocaleString()," FCFA"):""),a="";if("credit_note_refund"in e.data){var n=e.data.credit_note_refund,i=new Date(n.creationDate).toLocaleString();a=l.a.createElement("div",null,"Remboursement effectu\xe9 : ",n.value_to_refund," FCFA le ",i," ")}return l.a.createElement("div",{className:"flex-container flex-wrap text-left ticket-container flex-direction-column"},l.a.createElement("div",{className:"ticket-container "},t,l.a.createElement("div",{className:"ticket-container-action-buttons-div"},l.a.createElement("div",{className:""},e.children)),l.a.createElement("div",null,a)))}var Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).creditNoteValuesToShow=[{dataKeyToShow:"withFS",labelValue:"Avec FS ?",inputType:"checkbox"},{dataKeyToShow:"initialTicketAmount",labelValue:"Montant initial du ticket",inputType:"number"},{dataKeyToShow:"amountUsed",labelValue:"Montant utilis\xe9",inputType:"number"},{dataKeyToShow:"cancelationFees",labelValue:"Frais d'annulation",inputType:"number"},{dataKeyToShow:"agencyFees",labelValue:"Frais de service",inputType:"number"},{dataKeyToShow:"netToRefund",labelValue:"Net \xe0 rembourser",inputType:"number"}],a.state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.ticketToRefund?l.a.createElement("div",{className:"flex-1-1"},l.a.createElement("div",null,l.a.createElement("label",null,"Numero de ticket : "),this.props.ticketToRefund.ticketNumber),l.a.createElement("div",null,l.a.createElement("label",null,"Nom du voyageur : "),this.props.ticketToRefund.name),l.a.createElement("div",null,l.a.createElement("label",null,"Nom du compte : "),this.props.ticketToRefund.customerAccount)):l.a.createElement("div",{className:"text-center"},"No ticket Found");return l.a.createElement("div",null,l.a.createElement("div",{className:"flex-container flex-wrap text-left "},t,l.a.createElement("div",{className:"flex-1-1 "+(this.props.ticketToRefund?"babab ":"displayNone")},this.creditNoteValuesToShow.map(function(t){return l.a.createElement(Ie,{inputValue:e.props.creditNote[t.dataKeyToShow],labelValue:t.labelValue,keyToModify:t.dataKeyToShow,inputType:t.inputType,key:t.dataKeyToShow,onChange:function(t){return e.props.handleInputChangeOnCreditNote(t)}})}))),l.a.createElement("div",null,this.props.children))}}]),t}(n.Component),we={ticketNumber:"",passengerName:"",initialTicketAmount:0,amountUsed:0,cancelationFees:0,netToRefund:0,companyName:"",agencyFees:0,trip:"",emissionDate:"",flightDates:[],withFS:!0},Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={ticketNumberToFind:"",creditNote:Object.assign(we,{}),creditNoteAlreadyExist:!1,ticketToRefund:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"changeTicketNumber",value:function(e){var t=e.target.value;this.setState(Object(z.a)({},e.target.name,t))}},{key:"generateCreditNote",value:function(e,t){var a=Object.assign(this.state.creditNote,{});a.ticketNumber=e.ticketNumber,a.passengerName=e.name,a.customerId=e.customerId,a.customerAccount=e.customerAccount,a.trip=e.trip,a.flightDates=e.flightDates,a.emissionDate=e.date,a.companyName=e.companyName,this.parseCreditNoteValuesToInt(a),console.log("credit note generated",a),se.insertCreditNote(a).then(function(e){console.log(e),t.props.updateTicket(e.ticketsUpdated),t.props.addCreditNote(e.credit_note),t.findTicketToRefund()}).catch(function(e){console.log(e)})}},{key:"deleteExistingCreditNote",value:function(e){var t=this;"_id"in this.state.creditNote&&se.cancelCreditNote(this.state.creditNote).then(function(a){console.log(a),e.props.updateTicket(a.ticketsUpdated),e.props.deleteCreditNote(t.state.creditNote),e.setState({creditNote:we}),e.findTicketToRefund()}).catch(function(e){console.log(e)})}},{key:"parseCreditNoteValuesToInt",value:function(e){e.initialTicketAmount=parseInt(e.initialTicketAmount,10),e.amountUsed=parseInt(e.amountUsed,10),e.cancelationFees=parseInt(e.cancelationFees,10),e.agencyFees=parseInt(e.agencyFees,10),e.netToRefund=parseInt(e.netToRefund,10)}},{key:"updateCreditNote",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.creditNote,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object.assign({},e);t&&this.recalculateInitialTicketAmount(a,this.state.ticketToRefund),this.recalculateCreditNoteTotal(a),this.setState({creditNote:a})}},{key:"handleInputChangeOnCreditNote",value:function(e){var t=e.target,a=t.name,n="checkbox"===t.type?t.checked:this.checkIfStartWithZeroAndEliminateIt(t.value),l=Object.assign({},this.state.creditNote);l[a]=n,this.updateCreditNote(l,"withFS"===t.name)}},{key:"checkIfStartWithZeroAndEliminateIt",value:function(e){return e.length>1&&"0"===e.toString()[0]?e.toString().substring(1):0===e.length?0:e}},{key:"recalculateCreditNoteTotal",value:function(e){e.netToRefund=e.initialTicketAmount-e.amountUsed-e.cancelationFees-e.agencyFees}},{key:"recalculateInitialTicketAmount",value:function(e,t){e.initialTicketAmount=e.withFS?t.total:t.priceTTC}},{key:"findTicketToRefund",value:function(){var e=this,t=this.props.allTickets.find(function(t){return t._id.toString().indexOf(e.state.ticketNumberToFind)>-1});if(t){if(t)if("credit_note_refund"in t){var a=this.props.allCreditNotes.find(function(e){return e._id===t.credit_note_refund.credit_note_id});console.log("credit Note found",a),this.setState({creditNoteAlreadyExist:!0,creditNote:a})}else this.setState({creditNoteAlreadyExist:!1,creditNote:Object.assign({},we)})}else t="";this.setState({ticketToRefund:t}),setTimeout(function(){return e.updateCreditNote(e.state.creditNote,!0)},100)}},{key:"render",value:function(){var e=this,t=this.props.allTickets.find(function(t){return t._id.toString().indexOf(e.state.ticketNumberToFind)>-1}),a="";if(this.state.ticketToRefund){var n=l.a.createElement("div",null,"Pas d'avoir existant ");this.state.creditNoteAlreadyExist&&(n=l.a.createElement("div",null,"Avoir d\xe9j\xe0 existant \xe0 supprimer ")),a=l.a.createElement("div",null,l.a.createElement(Be,{className:"flex-container ",data:this.state.ticketToRefund,handleInputChangeOnTicket:function(e){}}),this.state.creditNoteAlreadyExist?l.a.createElement("button",{onClick:function(){return e.deleteExistingCreditNote(e)},disabled:!this.state.creditNoteAlreadyExist},"Supprimer avoir d\xe9j\xe0 existant"):l.a.createElement("button",{onClick:function(){return e.generateCreditNote(t,e)},disabled:this.state.creditNoteAlreadyExist},"Valider avoir"),n)}return l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("div",null,l.a.createElement("label",null,"Numero de ticket "),l.a.createElement("input",{placeholder:"Ticket number",type:"text",name:"ticketNumberToFind",onChange:function(t){return e.changeTicketNumber(t)}}),l.a.createElement("button",{onClick:function(){return e.findTicketToRefund()}},"Trouver billet")),a,l.a.createElement(Oe,{ticketToRefund:this.state.ticketToRefund,creditNote:this.state.creditNote,handleInputChangeOnCreditNote:function(t){return e.handleInputChangeOnCreditNote(t)}}))}}]),t}(n.Component),Ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={billCreationStage:0,accountSelected:"",creditNoteBillSelected:"",creditNotesSelected:[],creditNoteNumber:"",billTotalMoneyNumbers:"",isValidateBillButtonDisabled:"",validateButtonMessage:"",commandNumber:"",remarks:"",dateToShow:"",paymentType:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onAccountSelected",value:function(e){console.log("accountSelected",e),this.setState({accountSelected:e,creditNotesSelected:[],paymentType:e["paiement type"]}),this.setBillCreationStage(1)}},{key:"onCreditNoteBillSelected",value:function(e){console.log("creditNoteBillSelected",e),this.setState({creditNoteBillSelected:e,creditNotesSelected:[],paymentType:e["paiement type"],dateToShow:e.creationDate}),this.findCreditNotesFromBill(e),this.setBillCreationStage(2)}},{key:"findCreditNotesFromBill",value:function(e){var t=e.credit_notes.map(function(e){return e[0]}),a=this.props.allCreditNotes.filter(function(e){return t.includes(e._id)});console.log(a),this.setState({creditNotesSelected:a})}},{key:"findAccountBilledFromBill",value:function(e){this.setState({accountSelected:this.props.allAccount.find(function(t){return t._id===e.customerId})})}},{key:"setBillCreationStage",value:function(e){this.setState({billCreationStage:e})}},{key:"unselectAccount",value:function(){this.setBillCreationStage(0),this.setState({accountSelected:""})}},{key:"unselectCreditNoteBill",value:function(){this.setBillCreationStage(1),this.setState({creditNoteBillSelected:"",creditNotesSelected:[],paymentType:""})}},{key:"filterFunction",value:function(e){return!e.canceled&&e.customerId===this.state.accountSelected._id}},{key:"sendCancelCreditNoteBillRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;se.cancelCreditNoteBillRequest(e).then(function(e){e&&(console.log("creditNoteBillReturned",e),t.props.cancelCreditNoteBill(e.credit_note_bill,e.credit_notes_updated),t.unselectCreditNoteBill())})}},{key:"render",value:function(){var e=this,t=this.props.allCreditNoteBills.filter(function(t){return e.filterFunction(t,e)});return console.log(t),l.a.createElement("div",{className:"flex-container flex-direction-column "},l.a.createElement("div",{className:"margin-left-right-auto"},l.a.createElement("div",{onClick:function(){return e.unselectAccount()}},"Choisir compte"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onAccountSelected(t)},data:this.props.allAccount,sortBy:"name",dataKeysToShow:["name","customer reference"],filterPossibilities:["name","customer reference"],multiChoice:!1,className:0===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(be,{accountToShow:this.state.accountSelected,className:this.state.billCreationStage>0?"":"displayNone"})),l.a.createElement("div",{className:(this.state.billCreationStage>0?"":"displayNone ")+"margin-left-right-auto"},l.a.createElement("div",{onClick:function(){return e.unselectCreditNoteBill()}},"Selectionner factures"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onCreditNoteBillSelected(t)},data:t,dataKeysToShow:["billNumber","customer reference"],filterPossibilities:["billNumber","customer reference"],multiChoice:!1,className:1===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(W,{dataToRender:[this.state.creditNoteBillSelected],onElementClick:function(e){return console.log(e)},dataKeysToShow:["creationDate","passengerName","initialTicketAmount","netToRefund"],className:this.state.billCreationStage>1?"":"displayNone"})),l.a.createElement("div",{className:"flex-container padding-20px margin-20-px"},l.a.createElement(Ce,{printable:!0,accountSelected:this.state.accountSelected,creditNotes:this.state.creditNotesSelected,dateToShow:this.state.dateToShow,billNumber:this.state.creditNoteBillSelected.billNumber,commandNumber:this.state.creditNoteBillSelected.commandNumber,remarks:this.state.creditNoteBillSelected.remarks,valueToBill:this.state.valueToBill,showDetailsData:!0,paymentType:this.state.creditNoteBillSelected.paymentType,className:"flex-1-1"})),l.a.createElement("div",{className:this.state.creditNoteBillSelected?"":"displayNone"},l.a.createElement("button",{onClick:function(){return e.sendCancelCreditNoteBillRequest(e.state.creditNoteBillSelected)}},"Supprimer avoir ?")))}}]),t}(n.Component),je=a(659),_e=0,Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={creditNotes:[],creditNoteBills:[],viewSelected:_e},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;se.getAllCreditNotes().then(function(t){console.log("allCreditNotes",t),e.setState({creditNotes:t})}),se.getAllCreditNoteBills().then(function(t){console.log("allCreditNoteBills",t),e.setState({creditNoteBills:t})})}},{key:"addCreditNote",value:function(e){this.setState({creditNotes:this.state.creditNotes.concat([e])})}},{key:"addCreditNoteBill",value:function(e,t){console.log(e),console.log("creditnotes concatened",this.state.creditNotes.concat([t])),this.setState({creditNoteBills:this.state.creditNoteBills.concat([e])}),this.updateCreditNotes(t)}},{key:"cancelCreditNoteBill",value:function(e,t){console.log(e);var a=h()(this.state.creditNoteBills);a.splice(a.findIndex(function(t){return t._id===e._id}),1,e),this.setState({creditNoteBills:a}),this.updateCreditNotes(t)}},{key:"updateCreditNotes",value:function(e){var t=h()(this.state.creditNotes);console.log("creditNotesModified",e);var a=!0,n=!1,l=void 0;try{for(var i,r=function(){var e=i.value;console.log("creditNotesModified",e),t.splice(t.findIndex(function(t){return t._id===e._id}),1,e)},o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0)r()}catch(c){n=!0,l=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw l}}this.setState({creditNotes:t})}},{key:"deleteCreditNote",value:function(e){var t=this.state.creditNotes.slice(),a=t.findIndex(function(t){return t._id===e._id});console.log("credit note to delete _id found",a),t.splice(a,1),console.log("after deletion",t),this.setState({creditNotes:t})}},{key:"changeView",value:function(e){this.setState({viewSelected:e})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(je.a,{path:"/credit_notes/new",render:function(){return l.a.createElement(Fe,{allAccount:e.props.allAccount,allTickets:e.props.allTickets,allCreditNotes:e.state.creditNotes,updateTicket:function(t){return e.props.updateTicket(t)},addCreditNote:function(t){return e.addCreditNote(t)},deleteCreditNote:function(t){return e.deleteCreditNote(t)}})}}),l.a.createElement(je.a,{path:"/credit_notes/bill",render:function(){return l.a.createElement(xe,{allAccount:e.props.allAccount,allTickets:e.props.allTickets,allCreditNotes:e.state.creditNotes,addCreditNoteBill:function(t,a){return e.addCreditNoteBill(t,a)}})}}),l.a.createElement(je.a,{path:"/credit_notes/billed",render:function(){return l.a.createElement(Ve,{allAccount:e.props.allAccount,allTickets:e.props.allTickets,allCreditNotes:e.state.creditNotes,allCreditNoteBills:e.state.creditNoteBills,cancelCreditNoteBill:function(t,a){return e.cancelCreditNoteBill(t,a)}})}}))}}]),t}(n.Component),Re=(a(453),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={inputValue:"lol",ticketList:[],allAccount:a.props.allAccount,allTickets:a.props.allTickets,modalVisibility:!1,modalComponent:"",dateFilterInputValue:"",researchFilterInputValue:"",ticketToShowFilterFunction:a.getFilterFunction,maxNumberOfTicketsToShow:10},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleInputChangeOnTicket",value:function(e,a){var n=e.target,l=n.name,i="checkbox"===n.type?n.checked:n.value,r=h()(a);r[l]=i,t.recalculateTotal(r),this.updateTicket(r)}},{key:"addCustomerAccount",value:function(e,t){var a=h()(e);t&&(a.valid=!0,a.customerId=t._id,a.customerAccount=t.name),this.updateTicket(a)}},{key:"updateTicket",value:function(e){this.props.updateTicket(e)}},{key:"openModalAndChooseAccountForTicket",value:function(e){return new Promise(function(t,a){var n=l.a.createElement(J,{onValid:function(a){e.setModalVisibility(!1),t(a)},data:e.props.allAccount});e.setModalVisibility(!0,n)})}},{key:"validateTicket",value:function(e,t){var a=h()(e);a.checked=!0,D.validateTicket(a).then(function(e){e?t.updateTicket(a):console.log("erreur lors de l'enregistrement...")})}},{key:"setModalVisibility",value:function(e,t){(this.state.modalVisibility!==e||e)&&this.setState({modalVisibility:e}),t&&this.setState({modalComponent:t})}},{key:"changeTicketView",value:function(e){var t;t="valid"===e.target.name?this.getFilterFunction(!0):this.getFilterFunction(!1),this.setState({ticketToShowFilterFunction:t})}},{key:"getFilterFunction",value:function(e){var t=this,a="";return a=e?function(e){return!0===e.checked}:function(e){return!0!==e.checked},function(e){return a(e)&&e.date.indexOf(t.state.dateFilterInputValue)>-1&&(e.ticketNumber.indexOf(t.state.researchFilterInputValue)>-1||e.name.indexOf(t.state.researchFilterInputValue)>-1||e.accountName.indexOf(t.state.researchFilterInputValue)>-1)}}},{key:"handleFilterInputChange",value:function(e){var t=e.target.value;if("dateFilterInputValue"===e.target.name){var a=e.target.value.split("-");a[0]=a[0].substring(2),t=a.join("")}this.setState(Object(z.a)({},e.target.name,t.toUpperCase()))}},{key:"addEMDSAsNewTicket",value:function(e,t){return new Promise(function(a,n){var i=l.a.createElement(Le,{ticketData:e,onValid:function(e){t.setModalVisibility(!1),console.log("ticketCreated",e),a(e)}});t.setModalVisibility(!0,i)})}},{key:"render",value:function(){var e=this,t=this.props.allTickets.filter(this.state.ticketToShowFilterFunction).slice(0,this.state.maxNumberOfTicketsToShow).map(function(t){return l.a.createElement(Be,{className:"flex-container ",data:t,key:t._id,handleInputChangeOnTicket:function(a){return e.handleInputChangeOnTicket(a,t)}},l.a.createElement("button",{className:"validate-ticket-button",onClick:function(){e.openModalAndChooseAccountForTicket(e).then(function(a){return e.addCustomerAccount(t,a)})}},"Affecter compte client"),l.a.createElement("button",{className:" validate-ticket-button",disabled:!t.valid,onClick:function(){e.validateTicket(t,e)}},"Valider"),l.a.createElement("button",{className:" validate-ticket-button",onClick:function(){e.addEMDSAsNewTicket(t,e).then(function(t){t&&(console.log(" ticketTOAdd here",t),e.props.addTicket(t))})}},"EMDS"))});return l.a.createElement("div",{className:"flex-container-column"},l.a.createElement("div",{style:{margin:"10px 2px"},className:"sticky-top-0"},l.a.createElement("button",{onClick:function(t){return e.changeTicketView(t)},name:"not_valid"},"Billets \xe0 valider"),l.a.createElement("button",{onClick:function(t){return e.changeTicketView(t)},name:"valid"},"Billets valid\xe9s"),l.a.createElement("div",null,"Filtrer selon :",l.a.createElement("input",{placeholder:"Jour",type:"date",name:"dateFilterInputValue",onChange:function(t){return e.handleFilterInputChange(t)}}),l.a.createElement("input",{placeholder:"Filtrer",type:"text",name:"researchFilterInputValue",onChange:function(t){return e.handleFilterInputChange(t)}}))),l.a.createElement(f,{visible:this.state.modalVisibility,onOutsideClick:function(){return e.setModalVisibility(!1,"")}},this.state.modalComponent),l.a.createElement("div",{className:" all-tickets-scrollable flex-1-1"},t))}}],[{key:"recalculateTotal",value:function(e){e.total=parseInt(e.priceTTC,10)+parseInt(e.fees,10)}}]),t}(n.Component)),Le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={ticket:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(console.log("next pros",e),e.ticketData!==this.props.ticketData){console.log(" on est dedans",e);var t=this.retrieveTicketFromProps(e);this.setState({ticket:t})}}},{key:"componentDidMount",value:function(){this.props.ticketData&&this.setState({ticket:this.retrieveTicketFromProps(this.props)})}},{key:"retrieveTicketFromProps",value:function(e){if(e.ticketData){console.log(" on est dedans",e);var t=h()(e.ticketData);return t.referenceTicket=t._id,t.isEMDS=!0,t[" ticketNumber"]="",t.commissionRate=0,t.commissionValue=0,t.fees=0,t.total=0,t.priceHT=0,t.priceTTC=0,delete t._id,delete t[" credit_note_refund"],delete t.billed,console.log(" ticket to create",t),t}return{}}},{key:"handleInputChangeOnEMDSTicketInCreation",value:function(e){var t=e.target,a=t.name,n=" checkbox"===t.type?t.checked:t.value,l=h()(this.state.ticket);l[a]=n,Re.recalculateTotal(l),this.setState({ticket:l}),console.log(n,a,l)}},{key:"createTicket",value:function(){var e=this,t=this.state.ticket;t._id=t[" ticketNumber"],console.log(t),D.insertTicket(t).then(function(){e.props.onValid(t)})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(Be,{className:" flex-container ",data:this.state.ticket,handleInputChangeOnTicket:function(t){return e.handleInputChangeOnEMDSTicketInCreation(t)}},l.a.createElement("button",{onClick:function(){return e.createTicket()},disabled:!this.state.ticket.ticketNumber},"Create EMDS")))}}]),t}(n.Component),Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).VALIDATE_BILL="Validate bill",a.VALIDATION_IN_PROGRESS="En cours",a.VALIDATION_DONE="Validation effectu\xe9e",a.VALIDATION_ERROR="Erreur lors de la validation",a.state={accountName:"",accountSelected:"",ticketsSelected:[],keyToResearch:"",valueToResearch:"",selected:[],multiChoice:a.props.multiChoice,billNumber:"",commandNumber:"",remarks:"",isValidateBillButtonDisabled:!1,validateButtonMessage:a.VALIDATE_BILL,dateToShow:(new Date).getTime(),billTotalMoneyNumbers:{totalToPay:0,fees:0,discount:0,TVA:0,netToPay:0,netToPayInLetters:pe(0)},billToValidate:{},billCreationStage:0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onAccountSelected",value:function(e){console.log("accountSelected",e),this.setState({accountSelected:e,ticketsSelected:[]}),this.setBillCreationStage(1),x.getFromServer("tickets/",{customerId:e._id,billed:{$exists:!1},canceled:{$exists:!1}}).then(function(e){return console.log(e)})}},{key:"unselectAccount",value:function(){this.setBillCreationStage(0),this.setState({accountSelected:""})}},{key:"setBillCreationStage",value:function(e){this.setState({billCreationStage:e})}},{key:"filterFunction",value:function(e,t){return!0===e.checked&&e.customerId===t.state.accountSelected._id&&!e.canceled&&!Object.keys(e).includes("billed")}},{key:"onTicketSelected",value:function(e){var t=this;console.log("ticketsSelected",e);var a=e.reduce(function(e,a){return e+parseInt(a[t.getValueToBill()],10)},0),n={totalToPay:a,fees:0,discount:0,TVA:0,netToPay:a+0+0+0,netToPayInLetters:pe(a+0+0+0)};D.getNextBillNumber().then(function(e){return t.setState({billNumber:e})}),this.setState({ticketsSelected:e,billTotalMoneyNumbers:n,isValidateBillButtonDisabled:!1,validateButtonMessage:this.VALIDATE_BILL}),this.setBillCreationStage(2)}},{key:"handleInputChange",value:function(e){this.setState(Object(z.a)({},e.target.name,e.target.value))}},{key:"getValueToBill",value:function(){return this.state.accountSelected["with FS"]?"total":"priceTTC"}},{key:"generateBill",value:function(){var e=this,t={tickets:this.state.ticketsSelected.map(function(t){return[t._id,parseInt(t[e.getValueToBill()],10)]},this.state.accountSelected["with FS"]),customerAccount:this.state.accountSelected._id,billNumber:this.state.billNumber,commandNumber:this.state.commandNumber,totalBilled:this.state.billTotalMoneyNumbers.netToPay,remarks:this.state.remarks,creationDate:(new Date).getTime()};this.insertBillToDatabase(t,this)}},{key:"insertBillToDatabase",value:function(e,t){console.log(e),this.setState({isValidateBillButtonDisabled:!0,validateButtonMessage:this.VALIDATION_IN_PROGRESS}),D.insertBill(e).then(function(a){console.log(a),t.setState({validateButtonMessage:t.VALIDATION_DONE,dateToShow:e.creationDate}),a.ticketsUpdated.map(function(e){return t.props.updateTicket(e)})}).catch(function(a){t.setState({validateButtonMessage:t.VALIDATION_ERROR,dateToShow:e.creationDate}),console.log(a)})}},{key:"render",value:function(){var e=this,t=this.props.allTickets.filter(function(t){return e.filterFunction(t,e)});return l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("div",{className:"flex-container flex-direction-column margin-bottom-20px "},l.a.createElement("div",{className:"margin-left-right-auto margin-bottom-20px"},l.a.createElement("a",{onClick:function(){return e.unselectAccount()},style:{margin:"10px",fontWeight:700}},"Choisir compte"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onAccountSelected(t)},sortBy:"name",data:this.props.allAccount,dataKeysToShow:["name","customer reference"],filterPossibilities:["name","customer reference"],multiChoice:!1,className:0===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(be,{accountToShow:this.state.accountSelected,className:this.state.billCreationStage>0?"":"displayNone"})),l.a.createElement("div",{className:"margin-left-right-auto margin-bottom-20px "+(this.state.accountSelected?"":"displayNone")},l.a.createElement("a",{onClick:function(){return e.setBillCreationStage(1)},style:{margin:"10px",fontWeight:700}},"Selectionner billets"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onTicketSelected(t)},sortBy:["name","ticketNumber"],data:t,dataKeysToShow:["ticketNumber","date","name","total"],filterPossibilities:["ticketNumber","name"],multiChoice:!0,className:1===this.state.billCreationStage?"":"displayNone"}),l.a.createElement(W,{dataToRender:this.state.ticketsSelected,onElementClick:function(e){return console.log(e)},dataKeysToShow:["ticketNumber","date","name","priceHT","priceTTC","fees","total"],className:this.state.billCreationStage>1?"":"displayNone"}))),l.a.createElement("div",{className:"flex-container padding-20px margin-20-px"},l.a.createElement("div",null,l.a.createElement("div",{className:"margin-left-right-auto position-sticky text-left "+(this.state.ticketsSelected.length>0?"":"displayNone")},l.a.createElement("div",null,l.a.createElement("label",null,"Facture n\xb0 : "),l.a.createElement("input",{name:"billNumber",value:this.state.billNumber,onChange:function(t){return e.handleInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Bon de commande : "),l.a.createElement("input",{name:"commandNumber",onChange:function(t){return e.handleInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",{className:"align-top"},"Remarques : "),l.a.createElement("textarea",{id:"remark-field-bill-maker",name:"remarks",onChange:function(t){return e.handleInputChange(t)}})),l.a.createElement("button",{className:this.state.ticketsSelected.length>0?"":"displayNone ",onClick:function(){return e.generateBill()},disabled:this.state.isValidateBillButtonDisabled},this.state.validateButtonMessage))),l.a.createElement(ge,{printable:!1,accountSelected:this.state.accountSelected,ticketsSelected:this.state.ticketsSelected,dateToShow:this.state.dateToShow,billNumber:this.state.billNumber,commandNumber:this.state.commandNumber,remarks:this.state.remarks,valueToBill:this.state.accountSelected["with FS"]?"total":"priceTTC",className:"flex-1-1"})))}}]),t}(n.Component),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).DELETE_BILL="Supprimer facture",a.state={billToShow:{},ticketsToShow:[],accountToShow:{},allBills:[],dateToShow:"",isDeleteBillButtonDisabled:!1,billTotalMoneyNumbers:{totalToPay:0,fees:0,discount:0,TVA:0,netToPay:0,netToPayInLetters:pe(0)}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getAllBills(this)}},{key:"getValueToBill",value:function(e){return e["with FS"]?"total":"priceTTC"}},{key:"getAllBills",value:function(e){setTimeout(function(){return D.getAllBills().then(function(t){e.setState({allBills:t})})},100)}},{key:"deleteBill",value:function(e,t){t.setState({isDeleteBillButtonDisabled:!0}),D.cancelBill(e._id).then(function(a){console.log(a);var n=h()(t.state.allBills);n.splice(t.state.allBills.findIndex(function(t){return t._id===e._id}),1),t.setState({billToShow:{},ticketsToShow:[],accountToShow:{},isDeleteBillButtonDisabled:!1,allBills:n}),a.ticketsUpdated.map(function(e){return t.props.updateTicket(e)})}).catch(function(e){t.setState({isDeleteBillButtonDisabled:!1}),console.log("petite erreur l'ami, ressaie",e)})}},{key:"handleClickOnBillToShow",value:function(e){var t=this;console.log(e);var a=this.props.allTickets.filter(function(t){return e.tickets.reduce(function(e,a){return e||a.includes(t._id)},!1)}).sort(function(e,t){return ce.sortAlphabatically(e.date+e.ticketNumber.substring(4),t.date+t.ticketNumber.substring(4))}),n=this.props.allAccount.filter(function(t){return t._id===e.customerAccount})[0],l=a.reduce(function(e,a){return e+parseInt(a[t.getValueToBill(n)],10)},0),i={totalToPay:l,fees:0,discount:0,TVA:0,netToPay:l+0+0+0,netToPayInLetters:pe(l+0+0+0)};this.setState({billToShow:e,ticketsToShow:a,accountToShow:n,billTotalMoneyNumbers:i,dateToShow:e.creationDate})}},{key:"getTicketsFromBill",value:function(e){return this.props.allTickets.filter(function(t){return e.tickets.reduce(function(e,a){return e||a.includes(t._id)},!1)})}},{key:"getAccountFromBill",value:function(e){return this.props.allAccount.find(function(t){return t._id===e.customerAccount})}},{key:"addDataToBill",value:function(e){if(e){var t=this.getTicketsFromBill(e),a=t.reduce(function(e,t){return e+t.name+" "},"");return{accountName:this.getAccountFromBill(e).name,billNumber:e.billNumber,passengerName:a,passengerNumber:t.length,passengerValueToShow:t.length.toString()+" voyageurs",bill:e,canceled:e.canceled?"Annul\xe9e":""}}}},{key:"render",value:function(){var e=this;console.log("allBills length",this.state.allBills.length);var t=this.state.allBills.map(function(t){return e.addDataToBill(t)});return l.a.createElement("div",{className:" margin-left-right-auto flex-container flex-direction-column"},"Liste factures :",l.a.createElement(H,{onValid:function(t){return e.handleClickOnBillToShow(t.bill)},data:t,dataKeysToShow:function(e){return["accountName","billNumber"].concat(e.passengerNumber>4?["passengerValueToShow"]:["passengerName"]).concat(["canceled"])},filterPossibilities:["accountName","billNumber","passengerName"],sortBy:["accountName","billNumber"],multiChoice:!1}),l.a.createElement(ge,{printable:!0,accountSelected:this.state.accountToShow,ticketsSelected:this.state.ticketsToShow,dateToShow:this.state.dateToShow,billNumber:this.state.billToShow.billNumber,commandNumber:this.state.billToShow.commandNumber,remarks:this.state.billToShow.remarks,valueToBill:this.state.billToShow.valueBilled?this.state.billToShow.valueBilled:this.state.accountToShow["with FS"]?"total":"priceTTC",showDetailsData:!0}),l.a.createElement("button",{className:this.state.ticketsToShow.length>0?"":"displayNone",onClick:function(){return e.deleteBill(e.state.billToShow,e)},disabled:this.state.isDeleteBillButtonDisabled},this.DELETE_BILL))}}]),t}(n.Component),Ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).VALIDATE_BILL="Validate bill",a.VALIDATION_IN_PROGRESS="En cours",a.VALIDATION_DONE="Validation effectu\xe9e",a.VALIDATION_ERROR="Erreur lors de la validation",a.state={accountName:"",accountsSelected:[],accountToBill:"",ticketsSelected:[],keyToResearch:"",valueToResearch:"",selected:[],multiChoice:a.props.multiChoice,billNumber:"",commandNumber:"",remarks:"",isValidateBillButtonDisabled:!0,validateButtonMessage:a.VALIDATE_BILL,dateToShow:"",billTotalMoneyNumbers:{totalToPay:0,fees:0,discount:0,TVA:0,netToPay:0,netToPayInLetters:pe(0)},billToValidate:{},billCreationStage:0,valueToBill:"fees",dateBeginFilterInputValue:"000000",dateEndFilterInputValue:"999999"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onAccountSelected",value:function(e){var t=this;console.log("accountToBill ad",e,Array.isArray(e),e.length),this.setState({accountsSelected:e,ticketsSelected:[]}),this.setBillCreationStage(1),1===e.length&&setTimeout(function(){t.onAccountToBillSelected(e[0])},100),D.getNextBillNumber().then(function(e){return t.setState({billNumber:e,isValidateBillButtonDisabled:!1,validateButtonMessage:t.VALIDATE_BILL})})}},{key:"onAccountToBillSelected",value:function(e){var t=this;this.setState({accountToBill:e}),this.setBillCreationStage(2);var a=this.props.allTickets.filter(function(e){return t.stateAccountFilterFunction(e,t)});this.onTicketSelected(a)}},{key:"unselectAccount",value:function(){this.setBillCreationStage(0),this.setState({accountToBill:""})}},{key:"setBillCreationStage",value:function(e){this.setState({billCreationStage:e})}},{key:"stateAccountFilterFunction",value:function(e,t){var a=t.state.accountsSelected.map(function(e){return e._id});return!0===e.checked&&a.includes(e.customerId)&&e.date>=t.state.dateBeginFilterInputValue&&e.date<=t.state.dateEndFilterInputValue&&!e.canceled}},{key:"filterFunction",value:function(e,t){return!0===e.checked&&e.customerId===t.state.accountToBill._id&&!e.canceled&&!Object.keys(e).includes("billed")}},{key:"onTicketSelected",value:function(e){var t=this;console.log("ticketsSelected",e);var a=e.reduce(function(e,a){return e+parseInt(a[t.getValueToBill()],10)},0),n={totalToPay:a,fees:0,discount:0,TVA:0,netToPay:a+0+0+0,netToPayInLetters:pe(a+0+0+0)};D.getNextBillNumber().then(function(e){return t.setState({billNumber:e})}),this.setState({ticketsSelected:e,billTotalMoneyNumbers:n,isValidateBillButtonDisabled:!1,validateButtonMessage:this.VALIDATE_BILL}),this.setBillCreationStage(2)}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value;this.setState(Object(z.a)({},e.target.name,a))}},{key:"getValueToBill",value:function(){return this.state.valueToBill?this.state.valueToBill:this.state.accountToBill["with FS"]?"total":"priceTTC"}},{key:"setValueToBill",value:function(e){this.setState({valueToBill:e})}},{key:"generateBill",value:function(e,t){var a=this,n={tickets:e.map(function(e){return[e._id,parseInt(e[a.getValueToBill()],10)]},this.state.valueToBill),customerAccount:this.state.accountToBill._id,billNumber:this.state.billNumber,commandNumber:this.state.commandNumber,totalBilled:t,remarks:this.state.remarks,valueBilled:this.getValueToBill(),creationDate:(new Date).getTime()};this.insertBillToDatabase(n,this)}},{key:"handleDateFilterInputChange",value:function(e){var t=e.target.value.split("-");t[0]=t[0].substring(2);var a=t.join("");console.log(a),this.setState(Object(z.a)({},e.target.name,a))}},{key:"insertBillToDatabase",value:function(e,t){console.log(e),this.setState({isValidateBillButtonDisabled:!0,validateButtonMessage:this.VALIDATION_IN_PROGRESS}),D.insertBill(e).then(function(a){console.log(a),t.setState({validateButtonMessage:t.VALIDATION_DONE,dateToShow:e.creationDate}),a.ticketsUpdated.map(function(e){return t.props.updateTicket(e)})}).catch(function(a){t.setState({validateButtonMessage:t.VALIDATION_ERROR,dateToShow:e.creationDate}),console.log(a)})}},{key:"getTicketFiltered",value:function(){var e=this;return this.props.allTickets.filter(function(t){return e.stateAccountFilterFunction(t,e)})}},{key:"render",value:function(){var e=this,t=(this.props.allTickets.filter(function(t){return e.filterFunction(t,e)}),this.getTicketFiltered()),a=t.reduce(function(t,a){return t+parseInt(a[e.getValueToBill()],10)},0),n=a+0+0+0;pe(n);return l.a.createElement("div",{className:"flex-container flex-direction-column"},l.a.createElement("div",{className:"flex-container flex-direction-column margin-bottom-20px "},l.a.createElement("div",{className:"margin-left-right-auto margin-bottom-20px"},l.a.createElement("div",{onClick:function(){return e.unselectAccount()}},"Choisir compte"),l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onAccountSelected(t)},data:this.props.allAccount,dataKeysToShow:["name","customer reference"],filterPossibilities:["name","customer reference"],multiChoice:!0,className:0===this.state.billCreationStage?"":"displayNone"}),l.a.createElement("div",{className:1===this.state.billCreationStage?"":"displayNone"},"Choisir le compte \xe0 facturer",l.a.createElement(W,{dataToRender:this.state.accountsSelected,onElementClick:function(t){return e.onAccountToBillSelected(t)},dataKeysToShow:["name","customer reference"]})),l.a.createElement("div",{className:this.state.billCreationStage>1?"":"displayNone"},"Compte de facturation",l.a.createElement("div",{className:"text-left margin-bottom-20px"},l.a.createElement("div",null,this.state.accountToBill.name),l.a.createElement("div",null,this.state.accountToBill["customer reference"]),l.a.createElement("div",null,this.state.accountToBill.adress),l.a.createElement("div",null,this.state.accountToBill.city+" - "+this.state.accountToBill.country),l.a.createElement("div",null,this.state.accountToBill["entire name"]),l.a.createElement("div",null,"Avec FS : "+this.state.accountToBill["with FS"]),l.a.createElement("div",null,"Type de paiement : "+this.state.accountToBill["paiement type"])),l.a.createElement("div",{className:this.state.accountsSelected.length>1?"":"displayNone"},"Comptes pr\xe9sents dans les etats",l.a.createElement(W,{dataToRender:this.state.accountsSelected,onElementClick:function(e){return console.log(e)},dataKeysToShow:["name","customer reference"]})))),l.a.createElement("div",{className:"margin-left-right-auto margin-bottom-20px "+(this.state.accountToBill?"":"displayNone")},l.a.createElement("div",null,l.a.createElement("label",null,"Date de d\xe9but"),l.a.createElement("input",{placeholder:"Jour",type:"date",name:"dateBeginFilterInputValue",onChange:function(t){return e.handleDateFilterInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Date de fin"),l.a.createElement("input",{placeholder:"Jour",type:"date",name:"dateEndFilterInputValue",onChange:function(t){return e.handleDateFilterInputChange(t)}})),l.a.createElement("div",null,[{textToShow:"billet normal",valueToBill:this.state.accountToBill["with FS"]?"total":"priceTTC"},{textToShow:"frais de service",valueToBill:"fees"}].map(function(t){return l.a.createElement("div",{key:t.textToShow,className:e.state.valueToBill===t.valueToBill?"bold-text":"",onClick:function(){return e.setValueToBill(t.valueToBill)}},t.textToShow)})))),l.a.createElement("div",{className:"flex-container padding-20px margin-20-px"},l.a.createElement("div",null,l.a.createElement("div",{className:"margin-left-right-auto text-left "+(this.state.ticketsSelected.length>0?"":"displayNone")},l.a.createElement("div",null,l.a.createElement("label",null,"Facture n\xb0 : "),l.a.createElement("input",{name:"billNumber",value:this.state.billNumber,onChange:function(t){return e.handleInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",null,"Bon de commande : "),l.a.createElement("input",{name:"commandNumber",onChange:function(t){return e.handleInputChange(t)}})),l.a.createElement("div",null,l.a.createElement("label",{className:"align-top"},"Remarques : "),l.a.createElement("textarea",{id:"remark-field-bill-maker",name:"remarks",onChange:function(t){return e.handleInputChange(t)}}))),l.a.createElement("button",{className:this.state.ticketsSelected.length>0?"":"displayNone ",onClick:function(){return e.generateBill(t,n)},disabled:this.state.isValidateBillButtonDisabled},this.state.validateButtonMessage)),l.a.createElement(ge,{accountSelected:this.state.accountToBill,ticketsSelected:t,dateToShow:this.state.dateToShow,billNumber:this.state.billNumber,commandNumber:this.state.commandNumber,remarks:this.state.remarks,valueToBill:this.state.valueToBill,showDetailsData:!0,className:"flex-1-1"})))}}]),t}(n.Component);function Ye(e){return l.a.createElement("div",null,l.a.createElement(je.a,{path:"/tickets/validate",render:function(){return l.a.createElement(Re,{allAccount:e.allAccount,allTickets:e.allTickets,updateTicket:function(t){return e.updateTicket(t)},addTicket:function(t){return e.addTicket(t)}})}}),l.a.createElement(je.a,{path:"/tickets/bill",render:function(){return l.a.createElement(Ke,{allAccount:e.allAccount,allTickets:e.allTickets,updateTicket:function(t){return e.updateTicket(t)}})}}),l.a.createElement(je.a,{path:"/tickets/billed",render:function(){return l.a.createElement(Pe,{allAccount:e.allAccount,allTickets:e.allTickets,updateTicket:function(t){return e.updateTicket(t)}})}}),l.a.createElement(je.a,{path:"/tickets/fees_bill",render:function(){return l.a.createElement(Ue,{allAccount:e.allAccount,allTickets:e.allTickets,updateTicket:function(t){return e.updateTicket(t)}})}}))}var He=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={filesToSendAttributes:[],filesToSendRead:[],fileSentResult:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleFileToSendChange",value:function(e){var t=this,a=e.target;this.setState({filesToSendAttributes:Array.from(a.files),filesToSendRead:[]}),setTimeout(function(){return t.readAllFiles()},100),console.log(Array.from(a.files))}},{key:"addToFileToSend",value:function(e){this.setState({filesToSendRead:this.state.filesToSendRead.concat([e])})}},{key:"readFileAndAddItToFilesToSend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,a=new FileReader;a.onloadend=function(){t.addToFileToSend({name:e.name,type:"AIR",data:a.result})},a.readAsBinaryString(e)}},{key:"readAllFiles",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,l=this.state.filesToSendAttributes[Symbol.iterator]();!(e=(n=l.next()).done);e=!0){var i=n.value;this.readFileAndAddItToFilesToSend(i,this)}}catch(r){t=!0,a=r}finally{try{e||null==l.return||l.return()}finally{if(t)throw a}}}},{key:"sendAirFiles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;D.sendAIRFiles(this.state.filesToSendRead).then(function(t){return e.showImportedFiles(t)})}},{key:"showImportedFiles",value:function(e){var t=e.map(function(e){return l.a.createElement("div",{key:e.ticketNumber},e.ticketNumber+" / "+e.name)});t.unshift(l.a.createElement("div",{key:"summary"},e.length+" tickets import\xe9s. Veuillez actualiser la page")),this.setState({fileSentResult:t})}},{key:"testAllFilesWereRead",value:function(){var e=this;if(!this.state.filesToSendAttributes.length)return"Pas de fichier s\xe9lectionn\xe9";var t=this.state.filesToSendRead.map(function(e){return e.name}),a=!0,n=!1,i=void 0;try{for(var r,o=this.state.filesToSendAttributes.map(function(e){return e.name})[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var c=r.value;if(!t.includes(c))return"En chargement"}}catch(s){n=!0,i=s}finally{try{a||null==o.return||o.return()}finally{if(n)throw i}}return l.a.createElement("button",{onClick:function(){return e.sendAirFiles()}},"Envoyer fichiers")}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",null,"Importation des composants"),l.a.createElement("br",null),l.a.createElement("div",null,"Veuillez s\xe9lectionner les fichiers \xe0 importer et valider"),l.a.createElement("br",null),l.a.createElement("div",null,l.a.createElement("input",{name:"filesToUpload[]",id:"filesToUpload",onChange:function(t){return e.handleFileToSendChange(t)},type:"file",multiple:!0})),l.a.createElement("div",null,this.testAllFilesWereRead()),l.a.createElement("br",null),l.a.createElement("div",null,this.state.fileSentResult))}}]),t}(n.Component),Xe=a(266),We=a(261),Je=a(262),qe=a(263),ze=a(105),Qe=a(264),Ge=a.n(Qe),$e=a(80),Ze=a(265),et=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={filterText:"",resultText:"",openModalValue:!0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){D.getAllAirFiles()}},{key:"handleFilTerTextToSendChange",value:function(e){var t=e.target;this.setState({filterText:t.value})}},{key:"sendFilterTextAndRetrieveDecryptedData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;D.testAirFileDatas(this.state.filterText).then(function(a){a.map(function(e){return e._id=e.ticketNumber}),t.setState({resultText:a.map(function(t){return l.a.createElement(tt,{ticket:t,onClick:function(){return e.validateTicket(t)},key:t._id})})}),console.log(a)})}},{key:"validateTicket",value:function(e,t){h()(e)}},{key:"render",value:function(){var e=this,t=Object($e.withStyles)({appBar:{position:"relative"},flex:{flex:1}})(function(t){var a=t.classes;return console.log(a),l.a.createElement(j.a,{open:e.state.openModalValue,onClose:function(){return e.setState({openModalValue:!1})}},l.a.createElement(We.a,{className:a.appBar},"Ecriture",l.a.createElement(Je.a,null,l.a.createElement(qe.a,{color:"inherit",onClick:e.handleClose,"aria-label":"Close"},l.a.createElement(Ge.a,null),l.a.createElement(Ze.a,{className:"fa fa-plus-circle"})),l.a.createElement(ze.a,{variant:"title",color:"inherit",className:a.flex},"Sound"),l.a.createElement(L.a,{color:"inherit",onClick:e.handleClose},"save"))),l.a.createElement(_.a,{id:"form-dialog-title"},"Subscribe"),l.a.createElement(M.a,null,l.a.createElement(Xe.a,null,"To subscribe to this website, please enter your email address here. We will send updates occasionally."),l.a.createElement(Y.a,{autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0})),"Autre texte",l.a.createElement(R.a,null,l.a.createElement(L.a,{onClick:e.handleClose,color:"primary"},"Cancel"),l.a.createElement(L.a,{onClick:e.handleClose,color:"primary"},"Subscribe")))});return l.a.createElement("div",null,l.a.createElement("div",null,"Test Component"),l.a.createElement("div",null,l.a.createElement("input",{name:"filterTextValue",onChange:function(t){return e.handleFilTerTextToSendChange(t)},type:"text",multiple:!0})),l.a.createElement("br",null),l.a.createElement("button",{onClick:function(){return e.sendFilterTextAndRetrieveDecryptedData()}},"Send request"),l.a.createElement("div",null,this.state.filterText),l.a.createElement("div",{className:"flex-centered"},this.state.resultText),l.a.createElement(t,null))}}]),t}(n.Component);function tt(e){if(e.ticket){e.ticket.tripsInDetail.map(function(e){return e.name});return l.a.createElement("div",{className:"flex-container-column",style:{width:"600px"},onClick:function(){return e.onClick()}},l.a.createElement("div",{className:"flex-container"},l.a.createElement("span",{className:"flex-1-1 flex-centered"},e.ticket.name),l.a.createElement("span",{className:"flex-1-1"},l.a.createElement("div",{className:"bold-text"},"TKT ",e.ticket.ticketNumber),e.ticket.trip),l.a.createElement("span",{className:"flex-1-1 flex-centered"},e.ticket.accountName)),l.a.createElement("div",{className:"flex-container-column flex-centered"},e.ticket.tripsInDetail.map(function(e,t){return l.a.createElement(lt,{style:{width:"600px",border:"1px solid grey",borderRadius:"5px"},trip:e,key:t})})))}return l.a.createElement("div",null)}function at(e){return 4===e.trim().length?e[0]+e[1]+":"+e[2]+e[3]:e}function nt(e){return 9!==e.trim().length?e:e[0]+e[1]+" "+e[2]+e[3]+e[4]+" | "+at(e.slice(5))}function lt(e){if(e.trip){var t=e.trip;return l.a.createElement("div",{className:"",style:e.style},l.a.createElement("span",{className:"padding-5px "+("O"===t.tripType?"displayNone":"")},"Correspondance"),l.a.createElement("div",{className:"flex-container"},l.a.createElement("div",{className:"padding-5px flex-1-1"},l.a.createElement("div",null,t.departureCity+" ("+t.departureAirportCode+")"),l.a.createElement("div",null,l.a.createElement("i",{className:"fas fa-plane-departure padding-5px"}),nt(t.departureDayAndTime))),l.a.createElement("div",{className:"flex-centered"},l.a.createElement("div",null,l.a.createElement("i",{className:"far fa-clock padding-5px"}),at(t.tripLength))),l.a.createElement("div",{className:"padding-5px flex-1-1"},l.a.createElement("div",null,t.arrivalCity+" ("+t.arrivalAirportCode+")"),l.a.createElement("div",null,l.a.createElement("i",{className:"fas fa-plane-arrival padding-5px"}),nt(t.arrivalDayAndTime)))),l.a.createElement("div",{className:"flex-container"},l.a.createElement("span",{className:"padding-5px flex-1-1"},l.a.createElement("div",null,"Max weight  "),t.luggageNumber),l.a.createElement("span",{className:"padding-5px flex-1-1"},l.a.createElement("div",null,"Flight number "),t.flightNumber),l.a.createElement("span",{className:"padding-5px flex-1-1"},l.a.createElement("div",null,"Company "),t.company)))}return l.a.createElement("div",null,"No trip data")}var it=function(e){function t(e){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(rt,null))}}]),t}(n.Component),rt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={date:(new Date).toLocaleDateString(),dateX:0,dateY:0,date2X:0,date2Y:0,dateEnd:(new Date).toLocaleDateString(),dateEndX:0,dateEndY:0,customer:"",customerX:0,customerY:0,adress:"",amount:0,amountX:0,amountY:0,amountInLetter:"",amountInLetterX:0,amountInLetterY:0,imgContainer:"",timeOutToPositionBO:""},a.imgDiv=l.a.createRef(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({imgContainer:l.a.createElement("img",{ref:this.imgDiv,src:"/static/Fiche BO Vierge.jpg",style:{width:"1000px"},onClick:function(t){var a=t.target.getBoundingClientRect();e.setPosition(a)}})});var t=setTimeout(function(){return e.imgDiv.current.click()},1e3);this.setState({timeOutToPositionBO:t})}},{key:"onInputChange",value:function(e){this.setState(Object(z.a)({},e.target.name,e.target.value)),"amount"===e.target.name&&this.setState({amountInLetter:pe(parseInt(e.target.value))})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.state.timeOutToPositionBO)}},{key:"setPosition",value:function(e){this.setState({dateX:(e.right-e.left)/2-20,dateY:e.top+window.scrollY+104,date2X:(e.right-e.left)/2-140,date2Y:e.top+window.scrollY+150,dateEndX:(e.right-e.left)/2-120,dateEndY:e.top+window.scrollY+170,amountX:3*(e.left+e.right)/4,amountY:e.top+window.scrollY+168,amountInLetterX:(e.left+e.right)/2-70,amountInLetterY:e.top+window.scrollY+330,customerX:(e.left+e.right)/2+30,customerY:e.top+window.scrollY+363})}},{key:"render",value:function(){var e=this;console.log(this.state.imgContainer),console.log(this.imgDiv);var t=this.props.boToShow?this.props.boToShow:{customer:this.state.customer,amount:this.state.amount,date:this.state.date,dateEnd:this.state.dateEnd};return l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("input",{value:this.state.date,onChange:function(t){return e.onInputChange(t)},name:"date",placeholder:"date"}),l.a.createElement("input",{value:this.state.dateX,onChange:function(t){return e.onInputChange(t)},name:"dateX",placeholder:"dateX"}),l.a.createElement("input",{value:this.state.dateY,onChange:function(t){return e.onInputChange(t)},name:"dateY",placeholder:"dateY"})),l.a.createElement("div",null,l.a.createElement("input",{value:this.state.dateEnd,onChange:function(t){return e.onInputChange(t)},name:"dateEnd",placeholder:"dateEnd"}),l.a.createElement("input",{value:this.state.dateEndX,onChange:function(t){return e.onInputChange(t)},name:"dateEndX",placeholder:"dateEndX"}),l.a.createElement("input",{value:this.state.dateEndY,onChange:function(t){return e.onInputChange(t)},name:"dateEndY",placeholder:"dateEndY"})),l.a.createElement("div",null,l.a.createElement("input",{value:this.state.amount,onChange:function(t){return e.onInputChange(t)},name:"amount",placeholder:"amount"}),l.a.createElement("input",{value:this.state.amountX,onChange:function(t){return e.onInputChange(t)},name:"amountX",placeholder:"amountX"}),l.a.createElement("input",{value:this.state.amountY,onChange:function(t){return e.onInputChange(t)},name:"amountY",placeholder:"amountY"})),l.a.createElement("div",null,l.a.createElement("input",{value:this.state.amountInLetter,onChange:function(t){return e.onInputChange(t)},name:"amountInLetter",placeholder:"amountInLetter"}),l.a.createElement("input",{value:this.state.amountInLetterX,onChange:function(t){return e.onInputChange(t)},name:"amountInLetterX",placeholder:"amountInLetterX"}),l.a.createElement("input",{value:this.state.amountInLetterY,onChange:function(t){return e.onInputChange(t)},name:"amountInLetterY",placeholder:"amountInLetterY"})),l.a.createElement("div",null,l.a.createElement("input",{value:this.state.customer,onChange:function(t){return e.onInputChange(t)},name:"customer",placeholder:"client"}),l.a.createElement("input",{value:this.state.customerX,onChange:function(t){return e.onInputChange(t)},name:"customerX",placeholder:"clientX"}),l.a.createElement("input",{value:this.state.customerY,onChange:function(t){return e.onInputChange(t)},name:"customerY",placeholder:"clientY"})),l.a.createElement("input",{value:this.state.amount,onChange:function(t){return e.onInputChange(t)},name:"amount",placeholder:"amount"}),l.a.createElement("input",{value:this.state.date,onChange:function(t){return e.onInputChange(t)},name:"date",placeholder:"date"}),l.a.createElement("div",{className:" printable flex-container-column boPaperToPrint"},this.state.imgContainer,l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.dateX),top:parseInt(this.state.dateY)}},t.date),l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.date2X),top:parseInt(this.state.date2Y)}},"Du "+t.date),l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.dateEndX),top:parseInt(this.state.dateEndY)}},t.dateEnd),l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.amountX),top:parseInt(this.state.amountY)}},"# "+parseInt(t.amount).toLocaleString()+" #"),l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.amountInLetterX),top:parseInt(this.state.amountInLetterY),fontSize:"16px",maxWidth:"535px"}},pe(parseInt(t.amount))),l.a.createElement("div",{style:{position:"absolute",left:parseInt(this.state.customerX),top:parseInt(this.state.customerY)}},t.customer)))}}]),t}(n.Component),ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={dataToShow:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"showButtonToChangeDataToShow",value:function(){var e=this,t=[{name:"Tickets",data:this.props.allTickets},{name:"Comptes",data:this.props.allAccount},{name:"Avoirs",data:this.props.allTickets}];return l.a.createElement("div",{style:{margin:"10px"}},t.map(function(t){return l.a.createElement("button",{key:t.name,onClick:function(){return e.setState({dataToShow:t.data})}},t.name)}))}},{key:"render",value:function(){return l.a.createElement("div",null,this.showButtonToChangeDataToShow(),l.a.createElement(ee,{dataToShow:this.state.dataToShow}))}}]),t}(n.Component),ct=a(267),st=a.n(ct),ut=a(268),dt=a.n(ut);var mt=Object($e.withStyles)({root:{flexGrow:1,position:"fixed",top:"0px",height:"64px",width:"100%"},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20}})(function(e){var t=e.classes;return l.a.createElement("div",{className:t.root},l.a.createElement(st.a,{position:"static"},l.a.createElement(dt.a,null,l.a.createElement("div",{className:"flex-container"},e.statusDiv,l.a.createElement("div",{className:"flex-container selectViewBar white flex-3-1"}),l.a.createElement("div",{className:"flex-1-1"},e.logInDiv)))))}),ht=a(136),ft=a.n(ht),pt=a(184),bt=a.n(pt),vt=a(269),gt=a.n(vt),yt=a(273),kt=a.n(yt),Et=a(271),Tt=a.n(Et),Nt=a(272),St=a.n(Nt),Ct=a(270),At=a.n(Ct),Dt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={username:"",password:"",connexionRunning:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value;this.setState(Object(z.a)({},e.target.name,a))}},{key:"setConnexionRunning",value:function(e){this.setState({connexionRunning:e})}},{key:"connectAndRetrieveToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t={name:this.state.username,password:this.state.password};this.setConnexionRunning(!0),x.sendDataToRetrieveToken(t).then(function(t){console.log("token retrieved"),e.setConnexionRunning(!1),t&&e.setState({password:""})},function(t){e.setConnexionRunning(!1)})}},{key:"onEnterClick",value:function(e){"Enter"===e.key&&this.connectAndRetrieveToken()}},{key:"render",value:function(){var e=this;return l.a.createElement(gt.a,{open:this.props.connexionDialogOpen,onClose:function(){return null},"aria-labelledby":"form-dialog-title",onKeyPress:function(t){return e.onEnterClick(t)}},l.a.createElement(At.a,{id:"form-dialog-title"},"Connexion"),l.a.createElement(Tt.a,null,l.a.createElement(St.a,null,"Veuillez vous reconnecter svp"),l.a.createElement(bt.a,{autoFocus:!0,margin:"dense",name:"username",label:"Nom utilisateur",type:"text",value:this.state.username,onChange:function(t){return e.handleInputChange(t)},fullWidth:!0}),l.a.createElement(bt.a,{margin:"dense",name:"password",label:"Mot de passe",type:"password",value:this.state.password,onChange:function(t){return e.handleInputChange(t)},fullWidth:!0})),l.a.createElement(kt.a,null,l.a.createElement(ft.a,{onClick:function(){return e.props.handleClose(null)},color:"primary"},"Annuler"),l.a.createElement(ft.a,{onClick:function(){return e.connectAndRetrieveToken()},color:"primary",disabled:this.state.connexionRunning},"Valider")))}}]),t}(l.a.Component),xt=a(274),It=a.n(xt),Bt=a(15),Ot=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).handleClick=function(){e.setState({open:!0})},e.handleClose=function(){e.setState({open:!1})},e.state={open:!1,vertical:"top",horizontal:"center",message:"loli"},C.subscribe(function(t){e.setState({message:t}),e.handleClick({})}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.vertical,n=t.horizontal,i=t.open;return l.a.createElement(It.a,{anchorOrigin:{vertical:a,horizontal:n},autoHideDuration:5e3,open:i,onClose:this.handleClose,ContentProps:{"aria-describedby":"message-id",className:e.snackbar},message:this.state.message})}}]),t}(l.a.Component),wt=Object(Bt.a)(function(e){return{snackbar:{margin:"20px",width:"2000px"}}})(Ot),Ft=a(185),Vt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={shouldUpdateDataTableData:!1,currentKeysToShowObject:"",initialKeysToShow:"",selectorDatas:{X:0,Y:0,display:"none",validateFilterValues:function(e){return console.log(e)},datas:[]},sortBy:{},filterBy:{},simpleMenuAnchorEl:null,elementToModify:null,modifyElementModalOpen:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.startTime!==this.state.startTime&&this.setState({startTime:e.startTime}),this.refreshDataTableData(e)}},{key:"getDataKeysToShowFromData",value:function(e){var t=new Set,a=!0,n=!1,l=void 0;try{for(var i,r=e[Symbol.iterator]();!(a=(i=r.next()).done);a=!0)for(var o=i.value,c=Object.keys(o),s=0;s<c.length;s++){var u=c[s];t.add(u)}}catch(d){n=!0,l=d}finally{try{a||null==r.return||r.return()}finally{if(n)throw l}}return Object(Q.a)(t).reduce(function(e,t){return e[t]=t,e},{})}},{key:"setSortBy",value:function(e){var t=Object.assign({},this.state.sortBy);switch(t[e]){case-1:delete t[e];break;case 1:t[e]=-1;break;default:t[e]=1}this.setState({sortBy:t})}},{key:"checkIfSortedByKey",value:function(e){return Object.keys(this.state.sortBy).includes(e)}},{key:"getSortingFunction",value:function(e){var t=Object.keys(e).filter(function(t){return 0!==e[t]});return function(a,n){var l=!0,i=!1,r=void 0;try{for(var o,c=t[Symbol.iterator]();!(l=(o=c.next()).done);l=!0){var s=o.value;if(a[s]!==n[s])return(a[s]<n[s]?-1:1)*e[s]}}catch(u){i=!0,r=u}finally{try{l||null==c.return||c.return()}finally{if(i)throw r}}return 0}}},{key:"setFilterBy",value:function(e,t){var a=Object.assign({},this.state.filterBy);0===t.length?delete a[e]:a[e]=t,this.setState({filterBy:a})}},{key:"checkIfFilteredBy",value:function(e){return!!this.state.filterBy[e]}},{key:"getFilteringFunction",value:function(e){console.log(e);var t=Object.keys(e);return function(a){for(var n=0;n<t.length;n++){var l=t[n];if(!e[l].includes(a[l]))return!1}return!0}}},{key:"filterButtonClick",value:function(e,t,a){var n=this;e.stopPropagation();var l=e.target.parentNode.parentNode.getBoundingClientRect(),i=new Set,r=!0,o=!1,c=void 0;try{for(var s,u=a[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=s.value;i.add(d[t])}}catch(m){o=!0,c=m}finally{try{r||null==u.return||u.return()}finally{if(o)throw c}}console.log(i),this.setState({selectorDatas:{X:l.left+window.scrollX,Y:l.bottom+window.scrollY,display:"initial",validateFilterValues:function(e){n.setFilterBy(t,e),n.setState({selectorDatas:{display:"none"}})},datas:Object(Q.a)(i).sort(),selectedDatas:this.state.filterBy[t]}})}},{key:"refreshDataTableData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=this.getDataKeysToShowFromData(e.dataToShow);this.setState({initialKeysToShow:t,currentKeysToShowObject:t})}},{key:"setKeysToShowObject",value:function(e){this.setState({currentKeysToShowObject:e})}},{key:"getSortOrientation",value:function(e){return this.checkIfSortedByKey(e)?this.state.sortBy[e]>0?l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort-up"})):l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort-down"})):l.a.createElement("span",null,l.a.createElement("i",{className:"fas fa-sort"}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.currentKeysToShowObject),a=this.props.dataToShow.filter(this.getFilteringFunction(this.state.filterBy));a=(a=this.props.dataToShow).sort(this.getSortingFunction(this.state.sortBy));var n=l.a.createElement("thead",null,l.a.createElement("tr",null,t.map(function(t,a){return l.a.createElement("td",{key:a,onClick:function(){return e.setSortBy(t)}},l.a.createElement("div",{className:"flex"},l.a.createElement("span",{className:"flex-1-1"},e.state.currentKeysToShowObject[t]),e.getSortOrientation(t),l.a.createElement("span",{onClick:function(a){return e.filterButtonClick(a,t,e.props.dataToShow)}},l.a.createElement("i",{className:"fas fa-filter",style:{color:e.checkIfFilteredBy(t)?"red":""}}))))}))),i=a.map(function(a,n){var i=t.map(function(e,t){return l.a.createElement("td",{key:t},"object"===typeof a[e]?"object":a[e])});return l.a.createElement("tr",{key:n,onClick:function(t){return e.props.onElementClick(t,a)}},i)}),r=l.a.createElement("div",{id:"superDataTableDiv"},l.a.createElement("table",{id:"superDataTable",className:"text-left"},n,l.a.createElement("tbody",null,i)));return l.a.createElement("div",null,l.a.createElement(Z,{selectorDatas:this.state.selectorDatas}),r)}}]),t}(n.Component),jt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={dataToShow:[],accountSelected:null,collectionPath:null,simpleMenuData:{simpleMenuAnchorEl:null,elementToModify:null}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"showButtonToChangeDataToShow",value:function(){var e=this,t=[{name:"Comptes",collectionPath:"accounts/"},{name:"Tickets",collectionPath:"tickets/"},{name:"Factures",collectionPath:"bills/"},{name:"Avoirs",collectionPath:"credit_note/"},{name:"FacturesAvoirs",collectionPath:"credit_note/bill/"}];return l.a.createElement("div",{style:{margin:"10px"}},t.map(function(t){return l.a.createElement("button",{key:t.name,style:e.state.collectionPath===t.collectionPath?{backgroundColor:"#636363",color:"#e9e9e9"}:{},onClick:function(){return e.onClickOnDataCollection(t.collectionPath)}},t.name)}))}},{key:"onClickOnDataCollection",value:function(e){this.setState({collectionPath:e}),this.getDataFromServer(e)}},{key:"getDataFromServer",value:function(e){var t=this,a={};this.state.accountSelected&&(a={$or:[{customerAccount:this.state.accountSelected._id},{customerId:this.state.accountSelected._id}]}),x.getFromServer(e,a).then(function(e){return t.setState({dataToShow:e})})}},{key:"onAccountSelected",value:function(e){this.setState({accountSelected:e}),this.setModalVisibility(!1)}},{key:"setModalVisibility",value:function(e){this.setState({modalVisibility:e})}},{key:"onDataUpdate",value:function(e,t){var a=this;x.updateOnServer(this.state.collectionPath,e).then(function(){return t()}).then(function(){return a.modifyElementInDataToShow(a.state.collectionPath,e)})}},{key:"modifyElementInDataToShow",value:function(e,t){var a=Object(Q.a)(this.state.dataToShow),n=a.findIndex(function(e){return e._id===t._id});console.log(a,t,n),n>-1&&(a[n]=Object(Ft.a)({},t),this.setState({dataToShow:a}))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(L.a,{className:"validate-ticket-button",onClick:function(){return e.setModalVisibility(!0)}},this.state.accountSelected?this.state.accountSelected.name:"Choisir un compte"),this.showButtonToChangeDataToShow(),l.a.createElement(Vt,{dataToShow:this.state.dataToShow,onElementClick:function(t,a){console.log("modification TODO",t),t.preventDefault(),e.setState({simpleMenuData:{simpleMenuAnchorEl:t.target,elementToModify:a}})}}),l.a.createElement(V,{anchorEl:this.state.simpleMenuData.simpleMenuAnchorEl,handleClose:function(){e.setState({simpleMenuData:{simpleMenuAnchorEl:null,elementToModify:null}})},menuItems:[{text:"Modifier element",action:function(){return e.setState({simpleMenuData:Object(Ft.a)({},e.state.simpleMenuData,{simpleMenuAnchorEl:null}),modifyElementModalOpen:!0})}}]}),l.a.createElement(U,{open:this.state.modifyElementModalOpen,onClose:function(){return e.setState({modifyElementModalOpen:!1})},title:"Modifier objet",objectToModify:this.state.simpleMenuData.elementToModify,onValidate:function(t,a){return e.onDataUpdate(t,a)}}),l.a.createElement(f,{visible:this.state.modalVisibility,onOutsideClick:function(){return e.onAccountSelected(null)}},l.a.createElement(H,{onClick:function(e){return console.log(e)},onValid:function(t){e.onAccountSelected(t)},sortBy:"name",data:this.props.allAccount,dataKeysToShow:["name","customer reference"],filterPossibilities:["name","customer reference"],multiChoice:!1})))}}]),t}(n.Component),_t=a(135),Mt=a.n(_t),Rt=a(288),Lt=a.n(Rt),Kt=a(289),Pt=a.n(Kt),Ut=a(290),Yt=a.n(Ut),Ht=a(286),Xt=a.n(Ht),Wt=a(283),Jt=a.n(Wt),qt=a(276),zt=a.n(qt),Qt=a(275),Gt=a.n(Qt),$t=a(277),Zt=a.n($t),ea=a(278),ta=a.n(ea),aa=a(280),na=a.n(aa),la=a(279),ia=a.n(la),ra=a(281),oa=a.n(ra),ca=a(282),sa=a.n(ca),ua=a(284),da=a.n(ua),ma=a(285),ha=a.n(ma),fa=a(287),pa=a(297),ba="DIVIDER_CONST",va="COLLAPSE_MENU_CONST",ga=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleListItemClick=function(e,t,n){console.log("click on ",t),a.setState({selectedIndex:t,redirectionAddress:n,collapsedMenuSelectedIndex:null})},a.handleListItemCollapseClick=function(e,t,n){a.setState({collapsedMenuSelectedIndex:t,redirectionAddress:n})},a.tableauNavbar=[{title:"Tickets",redirectionAddress:null,icon:l.a.createElement(Gt.a,null)},{type:va,elements:[{title:"Valider",redirectionAddress:"/tickets/validate"},{title:"Facturer",redirectionAddress:"/tickets/bill"},{title:"Factures cr\xe9\xe9es",redirectionAddress:"/tickets/billed"},{title:"Facturer FS",redirectionAddress:"/tickets/fees_bill"}]},{title:"Comptes",redirectionAddress:"/accounts",icon:l.a.createElement(zt.a,null)},{title:"Avoirs",redirectionAddress:null,icon:l.a.createElement(Zt.a,null)},{type:va,elements:[{title:"Creer/Supprimer avoirs",redirectionAddress:"/credit_notes/new"},{title:"Facturer avoirs",redirectionAddress:"/credit_notes/bill"},{title:"Factures avoir cr\xe9\xe9es",redirectionAddress:"/credit_notes/billed"}]},{type:ba},{title:"Etats",redirectionAddress:"/states",icon:l.a.createElement(ta.a,null)},{title:"Importer AIR",redirectionAddress:"/import",icon:l.a.createElement(ia.a,null)},{type:ba},{title:"Controle Donn\xe9es",redirectionAddress:"/controlComponent",icon:l.a.createElement(na.a,null)},{title:"States 2.0",redirectionAddress:"/superDataTable",icon:l.a.createElement(oa.a,null)},{title:"B.O. generator",redirectionAddress:"/boComponent",icon:l.a.createElement(sa.a,null)},{title:"Nada",redirectionAddress:"/nada",icon:l.a.createElement(Jt.a,null)},{title:"Dashboard",redirectionAddress:"/dashboard",icon:l.a.createElement(da.a,null)},{title:"Bank",redirectionAddress:"/bank",icon:l.a.createElement(ha.a,null)}],a.state={selectedIndex:1,redirectionAddress:null,collapsedMenuSelectedIndex:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"generateMenuListItemFromData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return e.map(function(e,a){switch(e.type){case ba:return l.a.createElement(Xt.a,{key:a});case va:return l.a.createElement(fa.a,{in:t.state.selectedIndex===a-1,key:a,timeout:"auto",unmountOnExit:!0},l.a.createElement(Mt.a,{component:"div",disablePadding:!0},e.elements.map(function(e,a){return l.a.createElement(ya,{itemToShow:e,key:a,selectedIndex:t.state.collapsedMenuSelectedIndex,itemNumber:a,className:t.props.classes.nested,handleListItemClick:t.handleListItemCollapseClick})})));default:return l.a.createElement(ya,{key:a,itemToShow:e,selectedIndex:t.state.selectedIndex,itemNumber:a,handleListItemClick:t.handleListItemClick})}})}},{key:"checkRedirection",value:function(){var e=this.state.redirectionAddress;return e?(this.setState({redirectionAddress:null}),l.a.createElement(pa.a,{to:e})):""}},{key:"render",value:function(){var e=this.props.classes;return this.state.redirectionAddress?this.checkRedirection():l.a.createElement("div",{className:e.root},l.a.createElement(Mt.a,{component:"nav",className:e.nav},this.generateMenuListItemFromData(this.tableauNavbar)))}}]),t}(l.a.Component),ya=function(e){var t=e.itemToShow,a=e.itemNumber,n=e.selectedIndex,i=e.handleListItemClick,r=e.className;return l.a.createElement(Lt.a,{button:!0,className:r,selected:n===a,onClick:function(e){i(e,a,t.redirectionAddress)}},t.icon?l.a.createElement(Pt.a,null,t.icon):"",l.a.createElement(Yt.a,{inset:!0,primary:t.title}))},ka=Object($e.withStyles)(function(e){return{root:{maxWidth:360,width:"250px",backgroundColor:e.palette.background.paper,borderRight:"1px solid rgba(0, 0, 0, 0.12)",height:"100%",marginTop:0},nav:{width:"250px",overflow:"scroll",position:"absolute",marginTop:"64px",top:0,bottom:0,left:0,right:0},navContainer:{width:"250px"},nested:{paddingLeft:4*e.spacing.unit}}})(ga),Ea=a(296),Ta=a(650),Na=a(651),Sa=a(127),Ca=a(128),Aa=a(652),Da=a(625),xa=a(182),Ia=a(620),Ba=a(658),Oa=a(621),wa=a(653),Fa=a(622),Va=a(654),ja=a(623),_a=a(82),Ma=a(83),Ra=a(295),La=a(189),Ka=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"hslToRgb",value:function(e,t,a){var n,l,i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0===t)n=l=i=a;else{var o=function(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e},c=a<.5?a*(1+t):a+t-a*t,s=2*a-c;n=o(s,c,e+1/3),l=o(s,c,e),i=o(s,c,e-1/3)}return r?"#"+[Math.round(255*n),Math.round(255*l),Math.round(255*i)].map(function(e){return("00"+e.toString(16)).substr(-2)}).join(""):[Math.round(255*n),Math.round(255*l),Math.round(255*i)]}},{key:"rgbToHsl",value:function(e,t,a){e/=255,t/=255,a/=255;var n,l,i=Math.max(e,t,a),r=Math.min(e,t,a),o=(i+r)/2;if(i===r)n=l=0;else{var c=i-r;switch(l=o>.5?c/(2-i-r):c/(i+r),i){case e:n=(t-a)/c+(t<a?6:0);break;case t:n=(a-e)/c+2;break;case a:n=(e-t)/c+4}n/=6}return[n,l,o]}}]),e}(),Pa=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).CANCELED_PROPERTY="canceled",a.state={filter:{beginDate:"",endDate:""},tickets:[],ticketsHandled:[],generalDatas:{},chordDiagramMatrix:[],chordListLegend:[],chordListColors:[],bankDatas:{iata:"",ecobank:"",scb:"",scbDecouvert:"",cashier:"",BOs:"",result:""}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleFilterChange",value:function(e){var t=Object.assign({},this.state.filter,Object(z.a)({},e.target.name,e.target.value));this.setState({filter:t})}},{key:"handleBankDataChange",value:function(e){var t=Object.assign({},this.state.bankDatas,Object(z.a)({},e.target.name,e.target.value));this.setState({bankDatas:t})}},{key:"makeNextDayDate",value:function(e){return e.substr(0,e.length-1)+(parseInt(e.substr(e.length-1))+1)}},{key:"formatDateForTicketRequest",value:function(e){return e.substr(2).split("-").join("")}},{key:"getRecentBills",value:function(){var e=this,t=[];switch(this.state.filter.beginDate&&t.push({date:{$gte:this.formatDateForTicketRequest(this.state.filter.beginDate)}}),this.state.filter.endDate&&t.push({date:{$lte:this.formatDateForTicketRequest(this.state.filter.endDate)}}),t.length){case 0:return null;case 1:t=t[0];break;default:t={$and:t}}console.log(t),x.getFromServer("tickets/",t,{sort:{date:1},limit:0}).then(function(t){console.log(t.map(function(e){return e.canceled})),e.setState({tickets:t}),e.handleTicketData(t)})}},{key:"sortObjectsByKey",value:function(e,t){return e.reduce(function(e,a){return e.hasOwnProperty(a[t])?(e[a[t]].data.push(a),e):(e[a[t]]={data:[a]},e)},{})}},{key:"getGeneralDatasFromTickets",value:function(e){var t=this,a=e.reduce(function(e,t){return t.canceled||(e.totalCommission+=parseInt(t.commissionValue),e.totalAmountSold+=parseInt(t.total),e.totalPriceTTC+=parseInt(t.priceTTC),e.totalPriceHT+=parseInt(t.priceHT),e.totalTaxes+=parseInt(t.priceTTC)-parseInt(t.priceHT)),e.totalFees+=t.fees?parseInt(t.fees):0,e},{totalTicketsNumber:e.length,totalCanceledTicketsNumber:e.filter(function(e){return e.hasOwnProperty(t.CANCELED_PROPERTY)}).length,totalPriceTTC:0,totalPriceHT:0,totalTaxes:0,totalAmountSold:0,totalFees:0,totalCommission:0});this.setState({generalDatas:a})}},{key:"handleTicketData",value:function(e){this.getGeneralDatasFromTickets(e),this.setChordsData(e);for(var t=e.reduce(function(e,t){return e.hasOwnProperty(t.date)?(e[t.date].tickets.push(t),e):(e[t.date]={tickets:[t]},e)},{}),a=[],n=Object.keys(t),l=0;l<n.length;l++){var i=n[l],r={date:i,tickets:t[i].tickets};r=Object.assign(r,r.tickets.reduce(function(e,t){return e.totalValue+=t.total,e.fees+=t.fees?parseInt(t.fees):0,e.commissionValue+=parseInt(t.commissionValue),e.priceTTC+=parseInt(t.priceTTC),e},{totalValue:0,fees:0,commissionValue:0,priceTTC:0})),a.push(r)}console.log(a),this.setState({ticketsHandled:a})}},{key:"addKeyToTableauObject",value:function(e,t,a,n){if(e.hasOwnProperty(t))return{tableauObject:e,tableauChords:a,keyrank:n};e[t]=n,a.push(Object(Q.a)(Array(n)).map(function(e,t){return 0}));for(var l=Object.keys(e),i=0;i<l.length;i++)a[e[t=l[i]]].push(0);return{tableauObject:e,tableauChords:a,keyrank:n+=1}}},{key:"generateChordsData",value:function(e){for(var t=[],a={},n=0,l="",i="",r=0;r<e.length/2;r++){var o=e.slice(2*r,2*r+2),c=Object(Ea.a)(o,2),s=c[0];l=void 0===s?"":s;var u=c[1];i=void 0===u?"":u;var d=this.addKeyToTableauObject(a,l,t,n),m=d.keyrank;n=void 0===m?0:m;var h=d.tableauObject;a=void 0===h?{}:h;var f=d.tableauChords;t=void 0===f?[]:f;var p=this.addKeyToTableauObject(a,i,t,n),b=p.keyrank;n=void 0===b?0:b;var v=p.tableauObject;a=void 0===v?{}:v;var g=p.tableauChords;(t=void 0===g?[]:g)[a[i]][a[l]]+=1}return console.log(Object.keys(a)),{tableauObject:a,tableauChords:t}}},{key:"retrieveAllCitiesStop",value:function(e){var t=e.map(function(e){return e.tripsInDetail.reduce(function(t,a,n){return"X"===a.tripType?(0===n&&t.push(a.departureAirportCode),n<e.tripsInDetail.length-1&&"O"===e.tripsInDetail[n+1].tripType&&t.push(a.arrivalAirportCode)):(t.push(a.departureAirportCode),n<e.tripsInDetail.length-1&&"O"===e.tripsInDetail[n+1].tripType&&t.push(a.arrivalAirportCode)),n===e.tripsInDetail.length-1&&t.push(a.arrivalAirportCode),t},[])});return[].concat.apply([],t)}},{key:"setChordsData",value:function(e){console.log("ALLStops",e,this.retrieveAllCitiesStop(e));var t=this.retrieveAllCitiesStop(e),a=this.generateChordsData(t),n=a.tableauObject,l=void 0===n?{}:n,i=a.tableauChords,r=void 0===i?[]:i,o=Object.keys(l).length,c=parseInt("FFFFFF",16)/(o+3),s=1/(o+3),u=Object(Q.a)(new Array(o)).map(function(e,t){var a=t*s;return console.log(t,t*c,a,Ka.hslToRgb(a,100,50,!0)),Ka.hslToRgb(a,1,.5,!0)});console.log(c,o,u),this.setState({chordDiagramMatrix:r,chordListLegend:Object.keys(l),chordListColors:u})}},{key:"render",value:function(){var e=this,t=[{name:"priceHT",value:this.state.generalDatas.totalPriceHT},{name:"taxes",value:this.state.generalDatas.totalTaxes},{name:"totalFees",value:this.state.generalDatas.totalFees}];return console.log("data",t),console.log("dataChords",this.state.chordListLegend,this.state.chordDiagramMatrix),l.a.createElement("div",{style:{padding:"5px"}},l.a.createElement(Xa,{style:{marginBottom:"10px"},beginDate:this.state.filter.beginDate,endDate:this.state.filter.endDate,handleDateChange:function(t){return e.handleFilterChange(t)}},l.a.createElement("button",{onClick:function(){return e.getRecentBills()}},"Recup\xe8re tes billets ami")),Object.keys(this.state.generalDatas).map(function(t){return l.a.createElement("div",null,t," : ",e.state.generalDatas[t])}),l.a.createElement(La.a,{style:{padding:"20px"},matrix:this.state.chordDiagramMatrix,componentId:1,groupLabels:this.state.chordListLegend,groupColors:this.state.chordListColors}),l.a.createElement(Ua,{data:{lil:t}}),l.a.createElement(Ya,{data:this.state.ticketsHandled}),l.a.createElement(Ha,{data:this.state.ticketsHandled}),l.a.createElement(_a.a,null,l.a.createElement(Ma.a,null,l.a.createElement(Ta.a,{height:320},l.a.createElement(Na.a,{data:this.state.ticketsHandled},l.a.createElement(Sa.a,{dataKey:"date"}),l.a.createElement(Ca.a,{yAxisId:"0"}),l.a.createElement(Ca.a,{yAxisId:"paid",orientation:"right"}),l.a.createElement(Ca.a,{yAxisId:"fees"}),l.a.createElement(Aa.a,{vertical:!1,strokeDasharray:"3 3"}),l.a.createElement(Da.a,null),l.a.createElement(xa.a,null),l.a.createElement(Ia.a,{type:"monotone",name:"nb billets vendus",dataKey:"[tickets.length]",yAxisId:"0",stroke:"#82ca9d"}),l.a.createElement(Ia.a,{type:"monotone",name:"total ventes",dataKey:"totalValue",stroke:"#8884d8",yAxisId:"paid",activeDot:{r:8}}),l.a.createElement(Ia.a,{type:"monotone",name:"FS",dataKey:"fees",stroke:"#f284d8",yAxisId:"fees",activeDot:{r:8}}),l.a.createElement(Ia.a,{type:"monotone",name:"commission",dataKey:"commissionValue",stroke:"#3384d8",yAxisId:"fees",activeDot:{r:8}}))))),l.a.createElement(Wa,{className:"flex-1-1",bankDatas:this.state.bankDatas,handleChange:function(t){return e.handleBankDataChange(t)}}))}}]),t}(l.a.Component);function Ua(e){var t=e.data.lil;return console.log("dataTOshow",t,e),l.a.createElement(_a.a,null,l.a.createElement(Ma.a,null,l.a.createElement(Ba.a,{width:750,height:230},l.a.createElement(Oa.a,{data:t,dataKey:"value",fill:"#ae6623",cx:"50%",cy:"50%",outerRadius:100,innerRadius:60,label:!0}),l.a.createElement(Da.a,null))))}function Ya(e){return l.a.createElement(_a.a,{style:{margin:"10px"}},l.a.createElement(Ma.a,null,l.a.createElement(Ta.a,{height:320},l.a.createElement(wa.a,{height:500,data:e.data},l.a.createElement(Sa.a,{dataKey:"date"}),l.a.createElement(Ca.a,{yAxisId:"0"}),l.a.createElement(Da.a,null),l.a.createElement(xa.a,null),l.a.createElement(Fa.a,{dataKey:"priceTTC",stackId:"a",fill:"#8884d8"}),l.a.createElement(Fa.a,{dataKey:"fees",stackId:"a",fill:"#f284d8"}),l.a.createElement(Fa.a,{dataKey:"commissionValue",stackId:"a",fill:"#3384d8"})))))}function Ha(e){return l.a.createElement(_a.a,{style:{margin:"10px"}},l.a.createElement(Ma.a,null,l.a.createElement(Ta.a,{height:320},l.a.createElement(Va.a,{height:500,data:e.data},l.a.createElement(Sa.a,{dataKey:"date"}),l.a.createElement(Ca.a,{yAxisId:"0"}),l.a.createElement(Da.a,null),l.a.createElement(xa.a,null),l.a.createElement(ja.a,{dataKey:"priceTTC",stackId:"a",fill:"#8884d8"}),l.a.createElement(ja.a,{dataKey:"fees",stackId:"a",fill:"#f284d8"}),l.a.createElement(ja.a,{dataKey:"commissionValue",stackId:"a",fill:"#3384d8"})))))}function Xa(e){var t=[{label:"Date de debut",name:"beginDate",type:"date",value:e.beginDate},{label:"Date de fin",name:"endDate",type:"date",value:e.endDate}].map(function(t){return l.a.createElement(Y.a,{InputLabelProps:{shrink:!0},style:{margin:"20px"},type:t.type,variant:"outlined",label:t.label,name:t.name,key:t.name,value:t.value,placeholder:" ",onChange:function(t){return e.handleDateChange(t)},InputProps:{}})});return l.a.createElement(_a.a,{style:e.style},l.a.createElement(Ma.a,null,l.a.createElement("div",null,"Filtre Date"),l.a.createElement("div",{className:"flex-container"},t),e.children))}var Wa=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={result:0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getBankDatas",value:function(){var e=this.props.bankDatas;return[{label:"Facture IATA",name:"iata",type:"number"},{label:"Solde SCB",name:"scb",type:"number"},{label:"Solde Ecobank",name:"ecobank",type:"number"},{label:"Solde caisse",name:"cashier",type:"number"},{label:"Decouvert SCB",name:"scbDecouvert",type:"number"},{label:"BO constitu\xe9s",name:"BOs",type:"number"},{label:"Reste \xe0 trouver / constituer",name:"result",type:"number",value:e.iata-e.scb-e.ecobank-e.cashier-e.BOs,withColor:!0}]}},{key:"generateBankDatasFields",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBankDatas()).map(function(t){var a=t.value?t.value:e.props.bankDatas[t.name],n=t.withColor?a<0?"green":"red":"";return l.a.createElement(Y.a,{style:{margin:"20px"},variant:"outlined",type:t.type,label:t.label,name:t.name,key:t.name,value:a,placeholder:" ",onChange:function(t){return e.props.handleChange(t)},InputProps:{endAdornment:l.a.createElement(Ra.a,{position:"end"},"FCFA")},InputLabelProps:{style:{color:n}}})})}},{key:"render",value:function(){return l.a.createElement(_a.a,{className:this.props.className,style:{marginBottom:"10px"}},l.a.createElement(Ma.a,null,this.generateBankDatasFields()))}}]),t}(l.a.Component);var Ja=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"encode",value:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var n=e.charCodeAt(a);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}},{key:"decode",value:function(e){for(var t="",a=0,n=0,l=0,i=0;a<e.length;)(n=e.charCodeAt(a))<128?(t+=String.fromCharCode(n),a++):n>191&&n<224?(l=e.charCodeAt(a+1),t+=String.fromCharCode((31&n)<<6|63&l),a+=2):(l=e.charCodeAt(a+1),i=e.charCodeAt(a+2),t+=String.fromCharCode((15&n)<<12|(63&l)<<6|63&i),a+=3);return t}}]),e}(),qa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={filesToSendAttributes:[],filesToSendRead:[],fileSentResult:"",bankDataRead:[],bankDataTableRowsToImport:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleFileToSendChange",value:function(e){var t=this,a=e.target;this.setState({filesToSendAttributes:Array.from(a.files),filesToSendRead:[]}),setTimeout(function(){return t.readAllFiles()},100),console.log(Array.from(a.files))}},{key:"addToFileToSend",value:function(e){this.setState({filesToSendRead:this.state.filesToSendRead.concat([e])})}},{key:"readFileAndAddItToFilesToSend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,a=new FileReader;a.onloadend=function(){t.addToFileToSend({name:e.name,type:"AIR",data:a.result}),t.handleEcobankDatas(a.result)},a.readAsBinaryString(e)}},{key:"readAllFiles",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,l=this.state.filesToSendAttributes[Symbol.iterator]();!(e=(n=l.next()).done);e=!0){var i=n.value;this.readFileAndAddItToFilesToSend(i,this)}}catch(r){t=!0,a=r}finally{try{e||null==l.return||l.return()}finally{if(t)throw a}}}},{key:"sendAirFiles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;D.sendAIRFiles(this.state.filesToSendRead).then(function(t){return e.showImportedFiles(t)})}},{key:"showImportedFiles",value:function(e){var t=e.map(function(e){return l.a.createElement("div",{key:e.ticketNumber},e.ticketNumber+" / "+e.name)});t.unshift(l.a.createElement("div",{key:"summary"},e.length+" tickets import\xe9s. Veuillez actualiser la page")),this.setState({fileSentResult:t})}},{key:"testAllFilesWereRead",value:function(){var e=this;if(!this.state.filesToSendAttributes.length)return"Pas de fichier s\xe9lectionn\xe9";var t=this.state.filesToSendRead.map(function(e){return e.name}),a=!0,n=!1,i=void 0;try{for(var r,o=this.state.filesToSendAttributes.map(function(e){return e.name})[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var c=r.value;if(!t.includes(c))return"En chargement"}}catch(s){n=!0,i=s}finally{try{a||null==o.return||o.return()}finally{if(n)throw i}}return l.a.createElement("button",{onClick:function(){return e.handleSCBDatas(e.state.filesToSendRead[0].data)}},"Aucune action pour le moment")}},{key:"handleSCBDatas",value:function(e){console.log(e);var t=e.split(/\n|\u21b5/),a=[],n=t.map(function(e){var t=e.split(";");return a.push(l.a.createElement("tr",null,t.map(function(e,t){return l.a.createElement("td",{style:{border:"1px solid black"},key:t},Ja.decode(e))}))),{operationDate:t[0],description:t[1],debit:t[2],credit:t[3]}});this.setState({bankDataRead:n,bankDataTableRowsToImport:a}),console.log(n)}},{key:"parseFloatEcobank",value:function(e){try{return parseFloat(JSON.parse(e).split(",").join("")).toLocaleString()}catch(t){return e}}},{key:"handleEcobankDatas",value:function(e){var t=this,a=e.split(/\n{1,2}/),n=[],i=a.splice(10).map(function(e,a){var i=e.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).splice(2);return n.push(l.a.createElement("tr",{key:a},i.map(function(e,a){return l.a.createElement("td",{style:{border:"1px solid black"},key:a},t.parseFloatEcobank(e))}))),console.log(i,t.parseFloatEcobank(i[4])),{operationDate:i[0],valueDate:i[1],reference:i[2],description:i[3],debit:t.parseFloatEcobank(i[4]),credit:t.parseFloatEcobank(i[5]),accountValue:t.parseFloatEcobank(i[6])}});this.setState({bankDataRead:i,bankDataTableRowsToImport:n}),console.log(i)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",null,"Importation des donnees bank"),l.a.createElement("br",null),l.a.createElement("div",null,"Veuillez s\xe9lectionner le fichier \xe0 importer"),l.a.createElement("br",null),l.a.createElement("div",null,l.a.createElement("input",{name:"filesToUpload[]",id:"filesToUpload",onChange:function(t){return e.handleFileToSendChange(t)},type:"file",multiple:!0})),l.a.createElement("div",null,this.testAllFilesWereRead()),l.a.createElement("br",null),l.a.createElement("div",null,this.state.fileSentResult),l.a.createElement("table",null,l.a.createElement("tbody",null,this.state.bankDataTableRowsToImport)))}}]),t}(n.Component),za=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={allAccount:[],allTickets:[],inputValue:"lol",modalVisibility:!1,modalComponent:"",loggedIn:!0,ticketStatus:"",accountStatus:"",connexionDialogOpen:!1},N.subscribe(function(t){e.setLoggedIn(t),console.log("that's it")}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getAllAccounts(this),this.getAllTickets(this),this.setDecodedToken()}},{key:"setDecodedToken",value:function(){var e=k();!k()||k().length<1||this.setState({decodedToken:JSON.parse(window.atob(e.split(".")[1]))})}},{key:"setLoggedIn",value:function(e){this.setState({loggedIn:e}),this.setConnexionDialogOpen(!e),e&&this.componentDidMount(),console.log("loggedIn : ",this.state.loggedIn)}},{key:"logOutFromApp",value:function(){console.log("token removed"),localStorage.removeItem("token"),E(!1),this.setLoggedIn(!1),this.setState({allAccount:[],allTickets:[]}),this.resetStatus()}},{key:"getAllAccounts",value:function(e){this.setState({accountStatus:"Comptes en cours de chargement"}),x.getFromServer("accounts/").then(function(t){console.log(t.length," comptes disponibles"),e.setState({allAccount:t,accountStatus:t.length+" comptes charg\xe9s"})}).catch(function(t){e.setState({accountStatus:"Erreur chargement comptes"})})}},{key:"getAllTickets",value:function(e){this.setState({ticketStatus:"Tickets en cours de chargement"}),D.getAllTickets().then(function(t){var a=t;console.log(t.length," tickets cr\xe9\xe9s"),t&&e.setState({allTickets:a,ticketList:a.filter(function(e){return!0!==e.checked}),ticketStatus:t.length+" tickets charg\xe9s"})}).catch(function(t){e.setState({ticketStatus:"Erreur chargement tickets"})})}},{key:"updateTicket",value:function(e){var t=h()(this.state.allTickets),a=t.findIndex(function(t){return t._id===e._id});t[a]=e,this.setState({allTickets:t})}},{key:"addTicket",value:function(e){this.setState({allTickets:this.state.allTickets.concat([e])})}},{key:"addNewAccount",value:function(e){var t=h()(this.state.allAccount);t.push(e),this.setState({allAccount:t}),console.log("ticket updated",t,e)}},{key:"updateAccount",value:function(e){var t=h()(this.state.allAccount),a=t.findIndex(function(t){return t._id===e._id});t[a]=e,this.setState({allAccount:t})}},{key:"deleteAccount",value:function(e){var t=h()(this.state.allAccount),a=t.findIndex(function(t){return t._id===e._id});t.splice(a,1),this.setState({allAccount:t})}},{key:"setModalVisibility",value:function(e,t){(this.state.modalVisibility!==e||e)&&this.setState({modalVisibility:e}),t&&this.setState({modalComponent:t})}},{key:"resetStatus",value:function(){var e=this;setTimeout(function(){e.setState({ticketStatus:e.state.allTickets.length+" tickets charg\xe9s",accountStatus:e.state.allAccount.length+" comptes charg\xe9s"})},100)}},{key:"getStatusTextDiv",value:function(){return l.a.createElement("div",{className:"flex-1-1"},[this.state.ticketStatus,this.state.accountStatus].map(function(e,t){return l.a.createElement("div",{key:t},e)}))}},{key:"getLogInDiv",value:function(){var e=this;return this.state.loggedIn?l.a.createElement("div",null,l.a.createElement("div",null,this.state.decodedToken?this.state.decodedToken.name:""),l.a.createElement("div",{onClick:function(){return e.logOutFromApp()}},"Se d\xe9connecter")):l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("strong",null,"Non connect\xe9")),l.a.createElement("div",{onClick:function(){return e.setLoggedIn(!1)}},"Se connecter"))}},{key:"setConnexionDialogOpen",value:function(e){this.setState({connexionDialogOpen:e})}},{key:"render",value:function(){var e=this;return console.log("https://air-reader.herokuapp.com/"),l.a.createElement("div",{className:"App main-container"},l.a.createElement(mt,{className:"sticky-top-0",logInDiv:this.getLogInDiv(),statusDiv:this.getStatusTextDiv()}),l.a.createElement("div",{className:"flex-container ",style:{marginTop:"64px"}},l.a.createElement("div",null,l.a.createElement(ka,null)),l.a.createElement("div",{style:{overflowX:"auto",marginTop:"20px"},className:"flex-1-1"},l.a.createElement(je.a,{path:"/tickets",render:function(){return l.a.createElement(Ye,{allAccount:e.state.allAccount,allTickets:e.state.allTickets,updateTicket:function(t){return e.updateTicket(t)},addTicket:function(t){return e.addTicket(t)}})}}),l.a.createElement(je.a,{path:"/accounts",render:function(){return l.a.createElement(q,{allAccount:e.state.allAccount,addNewAccount:function(t){return e.addNewAccount(t)},updateAccount:function(t){return e.updateAccount(t)},deleteAccount:function(t){return e.deleteAccount(t)}})}}),l.a.createElement(je.a,{path:"/credit_notes",render:function(){return l.a.createElement(Me,{allAccount:e.state.allAccount,allTickets:e.state.allTickets,updateTicket:function(t){return e.updateTicket(t)}})}}),l.a.createElement(je.a,{path:"/creditNote",render:function(){return l.a.createElement(q,{allAccount:e.state.allAccount,addNewAccount:function(t){return e.addNewAccount(t)},updateAccount:function(t){return e.updateAccount(t)},deleteAccount:function(t){return e.deleteAccount(t)}})}}),l.a.createElement(je.a,{path:"/states",render:function(){return l.a.createElement(ce,{allAccount:e.state.allAccount,allTickets:e.state.allTickets})}}),l.a.createElement(je.a,{path:"/import",render:function(){return l.a.createElement(He,{allAccount:e.state.allAccount,allTickets:e.state.allTickets})}}),l.a.createElement(je.a,{path:"/test",render:function(){return l.a.createElement(et,{allAccount:e.state.allAccount,allTickets:e.state.allTickets})}}),l.a.createElement(je.a,{path:"/superDataTable",render:function(){return l.a.createElement(ot,{allAccount:e.state.allAccount,allTickets:e.state.allTickets})}}),l.a.createElement(je.a,{path:"/boComponent",render:function(){return l.a.createElement(it,{dataToShow:Qa})}}),l.a.createElement(je.a,{path:"/controlComponent",render:function(){return l.a.createElement(jt,{allAccount:e.state.allAccount})}}),l.a.createElement(je.a,{path:"/dashboard",render:function(){return l.a.createElement(Pa,null)}}),l.a.createElement(je.a,{path:"/bank",render:function(){return l.a.createElement(qa,null)}}))),l.a.createElement(f,{visible:this.state.modalVisibility,onOutsideClick:function(){return e.setModalVisibility(!1,"")}},this.state.modalComponent),l.a.createElement(Dt,{connexionDialogOpen:this.state.connexionDialogOpen,handleClose:function(){return e.setConnexionDialogOpen(!1)}}),l.a.createElement(wt,null))}}]),t}(n.Component),Qa=[{_id:"5b54e6b6866725996695fa0f",billNumber:"AFV/18/000331AB",credit_notes:[["5b50c5ad86672575f9a872d8",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290742811.237,canceled:!0},{_id:"5b54e21b866725996695fa05",billNumber:"AFV/18/000326AB",credit_notes:[["5b50c5ad86672575f9a872d8",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532289563859.993,canceled:!0},{_id:"5b54e6bd866725996695fa10",billNumber:"AFV/18/000332AB",credit_notes:[["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290749941.276,canceled:!0},{_id:"5b54e4ca866725996695fa0c",billNumber:"AFV/18/000330AB",credit_notes:[["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290250288.141,canceled:!0},{_id:"5b54e71e866725996695fa13",billNumber:"AFV/18/000333AB",credit_notes:[["5b54e6df866725996695fa12",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290846119.843,canceled:!0},{_id:"5b54e774866725996695fa15",billNumber:"AFV/18/000335AB",credit_notes:[["5b54e6df866725996695fa12",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290932496.048,canceled:!0},{_id:"5b54e725866725996695fa14",billNumber:"AFV/18/000334AB",credit_notes:[["5b54e6df866725996695fa12",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290853774.116,canceled:!0},{_id:"5b54e84d866725996695fa17",billNumber:"AFV/18/000337AB",credit_notes:[["5b4e6a928667253d8ae62cb7",301797]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:301797,creationDate:1532291149996.986,canceled:!0},{_id:"5b54e800866725996695fa16",billNumber:"AFV/18/000336AB",credit_notes:[["5b50c59c86672575f9a872d7",592200],["5b50c5ad86672575f9a872d8",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:1184400,creationDate:1532291072864.5789,canceled:!0},{_id:"5b54e0f2866725996695fa03",billNumber:"AFV/18/000325AB",credit_notes:[["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532289266251.4438,canceled:!0},{_id:"5b54e4c4866725996695fa0b",billNumber:"AFV/18/000329AB",credit_notes:[["5b50c5ad86672575f9a872d8",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290244382.1519,canceled:!0},{_id:"5b54e8b3866725996695fa1b",billNumber:"AFV/18/000338AB",credit_notes:[["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532291251783.4639,canceled:!0},{_id:"5b55acbe866725aff26d5eb3",billNumber:"AFV/18/000344AB",credit_notes:[["5b55ab6e866725aff26d5eb2",299200]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:299200,creationDate:1532341438673.8647,canceled:!0},{_id:"5b55a626866725aff26d5eb1",billNumber:"AFV/18/000342AB",credit_notes:[["5b50c5ad86672575f9a872d8",592200],["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:1184400,creationDate:1532339750123.447,canceled:!0},{_id:"5b55b17a866725aff26d5eb8",billNumber:"AFV/18/000348AB",credit_notes:[["5b559d16866725aead763aa7",785608],["5b55b056866725aff26d5eb6",617920]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:1403528,creationDate:1532342650875.0642,canceled:!0},{_id:"5b55b258866725aff26d5ebf",billNumber:"AFV/18/000351AB",credit_notes:[["5b559d16866725aead763aa7",785608],["5b55b056866725aff26d5eb6",617920]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:1403528,creationDate:1532342872760.459,canceled:!0},{_id:"5b55b679866725b25b60bafd",billNumber:"AFV/18/000352AB",credit_notes:[["5b559d16866725aead763aa7",785608]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:785608,creationDate:1532343929199.8247},{_id:"5b5609fc866725aff26d5ec3",billNumber:"AFV/18/000357AB",credit_notes:[["5b55b06c866725aff26d5eb7",123700],["5b55b1b7866725aff26d5ebb",433100]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:556800,creationDate:1532365308008.2021},{_id:"5b58b487866725f461b36847",billNumber:"AFV/18/000359AB",credit_notes:[["5b58b43e866725f461b36846",6370]],customerId:"5b3b88c486672557efc48442",customerAccount:"BUREAU REGIONAL DE LA BAD AU CAMEROUN",totalBilled:6370,creationDate:1532540039177.482},{_id:"5b55b1ce866725aff26d5ebc",billNumber:"AFV/18/000350AB",credit_notes:[["5b559d16866725aead763aa7",785608],["5b55b056866725aff26d5eb6",617920]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:1403528,creationDate:1532342734484.099,canceled:!0},{_id:"5b560878866725aff26d5ec2",billNumber:"AFV/18/000356AB",credit_notes:[["5b55ab6e866725aff26d5eb2",299200],["5b55addc866725aff26d5eb5",299200]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:598400,creationDate:1532364920640.861},{_id:"5b54e315866725996695fa07",billNumber:"AFV/18/000327AB",credit_notes:[["5b50c59c86672575f9a872d7",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532289813052.0142,canceled:!0},{_id:"5b58ba27866725f461b36849",billNumber:"AFV/18/000361AB",credit_notes:[["5b58b9e3866725f461b36848",31700]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:31700,creationDate:1532541479560.256},{_id:"5b54e42e866725996695fa09",billNumber:"AFV/18/000328AB",credit_notes:[["5b50c5ad86672575f9a872d8",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:592200,creationDate:1532290094476.22,canceled:!0},{_id:"5b59d7bb64ace80009f5eeb5",billNumber:"AFV/18/000365AB",credit_notes:[["5b55b056866725aff26d5eb6",617920]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:617920,creationDate:1532614587623.5454,canceled:!0},{_id:"5b58beaa866725f461b3684c",billNumber:"AFV/18/000364AB",credit_notes:[["5b58be0d866725f461b3684b",545420],["5b58be0d866725f461b3684b",6370]],customerId:"5b3b88c486672557efc48442",customerAccount:"BUREAU REGIONAL DE LA BAD AU CAMEROUN",totalBilled:551790,creationDate:1532542634962.2651},{_id:"5b5ed9cfd06f4700083bdc12",billNumber:"AFV/18/000368AB",credit_notes:[["5b5ed8aad06f470009a8bb03",592200],["5b5ed982d06f4700083bdc11",592200]],customerId:"5b48e1d5866725250c93d7d8",customerAccount:"MEKIN ",totalBilled:1184400,creationDate:1532020124821.352},{_id:"5b5f322422fc6e0009e6d814",billNumber:"AFV/18/000374AB",credit_notes:[["5b5f2f3e22fc6e0009e6d810",405850],["5b5f2fc022fc6e0009e6d811",304900],["5b5f300d22fc6e0009e6d812",891950],["5b5f308422fc6e000861baf7",426800],["5b5f30d822fc6e0009e6d813",325700]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:2355200,creationDate:1532965412578.9072},{_id:"5b5f3acc22fc6e000861bafc",billNumber:"AFV/18/000381AB",credit_notes:[["5b5f39c122fc6e000861bafa",303700]],customerId:"5b3b88c486672557efc48442",customerAccount:"BUREAU REGIONAL DE LA BAD AU CAMEROUN",totalBilled:303700,creationDate:1532967628120.2737},{_id:"5b5f3a5f22fc6e0009e6d816",billNumber:"AFV/18/000380AB",credit_notes:[["5b5f367722fc6e000861baf9",325700]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:325700,creationDate:1532967519435.9268},{_id:"5b5f39df22fc6e000861bafb",billNumber:"AFV/18/000379AB",credit_notes:[["5b5f35ad22fc6e0009e6d815",426800],["5b5f360922fc6e000861baf8",195700]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:622500,creationDate:1532967391980.6714},{_id:"5b617e090dada900081311dc",billNumber:"AFV/18/000383AB",credit_notes:[["5b617b850dada900081311da",305100]],customerId:"5b3b87c986672557efc48441",customerAccount:"BANQUE AFRICAINE DE DEVELOPPEMENT HDQ",totalBilled:305100,creationDate:1533115913221.525},{_id:"5b7e96919704670009281fae",billNumber:"AFV/18/000385AB",credit_notes:[["5b7e966a9704670009281fad",537100]],customerId:"5b3e346d8667256f5ebc5e3b",customerAccount:"CLIENT OCCASIONNEL",totalBilled:537100,creationDate:1535022737219.5159},{_id:"5b8e38565f7f300008da9b49",billNumber:"AFV/18/000389AB",credit_notes:[["5b8e35785f7f300008da9b47",73855],["5b8e35a35f7f3000093836f6",73855],["5b8e37fd5f7f300008da9b48",291800]],customerId:"5b35ee5a4f801633c5651028",customerAccount:"ICRC",totalBilled:439510,creationDate:1536047190752.1812}],Ga=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function $a(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Za=a(660);r.a.render(l.a.createElement(Za.a,{basename:"/webapp"},l.a.createElement(za,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");Ga?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):$a(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):$a(e)})}}()}},[[303,2,1]]]);
//# sourceMappingURL=main.e487629b.chunk.js.map